function hydraupdates(){function e(e,t,n){e.loadingPromise=t.getVersions().then(function(t){e.currentVersion=t.data.currentVersion,e.repVersion=t.data.repVersion,e.updateAvailable=t.data.updateAvailable,e.changelog=t.data.changelog}),t.getVersionHistory().then(function(t){e.versionHistory=n.trustAsHtml(t.data.versionHistory)}),e.update=function(){t.update()},e.showChangelog=function(){t.showChanges(e.changelog)}}return e.$inject=["$scope","UpdateService","$sce"],{templateUrl:"static/html/directives/updates.html",controller:e}}function titleRow(){function e(e){function t(){return e.expanded&&e.duplicates.length>1?(console.log("Showing all duplicates in group"),e.duplicates):(console.log("Showing first duplicate in group"),[e.duplicates[0]])}e.expanded=!1,console.log("Building title row"),e.duplicatesToShow=t}return{templateUrl:"static/html/directives/title-row.html",scope:{duplicates:"<",selected:"<",rowIndex:"@"},controller:["$scope","$element","$attrs",e]}}function titleGroup(){function e(e,t,n){function r(){return e.titles.slice(1)}e.expanded=!1,e.titleGroupExpanded=!1,e.$on("toggleTitleExpansion",function(t,n){e.titleGroupExpanded=n,t.stopPropagation()}),e.titlesToShow=r}return{templateUrl:"static/html/directives/title-group.html",scope:{titles:"<",selected:"=",rowIndex:"<",doShowDuplicates:"<",internalRowIndex:"@"},controller:["$scope","$element","$attrs",e],multiElement:!0}}function tabOrChart(){return{templateUrl:"static/html/directives/tab-or-chart.html",transclude:{chartSlot:"chart",tableSlot:"table"},restrict:"E",replace:!0,scope:{display:"@"}}}function searchResult(){function e(e,t,n){function r(){return e.showDuplicates&&e.titleGroup[0].length>1&&e.hashGroupExpanded[e.titleGroup[0][0].hash]?e.titleGroup[0].slice(1):[]}function o(){return e.titleGroup.length>1&&e.titleGroupExpanded?e.titleGroup.slice(1):[]}function a(t){return e.showDuplicates&&e.hashGroupExpanded[t[0].hash]?t.slice(1):[]}e.titleGroupExpanded=!1,e.hashGroupExpanded={},e.toggleTitleGroup=function(){e.titleGroupExpanded=!e.titleGroupExpanded,e.titleGroupExpanded||(e.hashGroupExpanded[e.titleGroup[0][0].hash]=!1)},e.groupingRowDuplicatesToShow=r,e.otherTitleRowsToShow=o,e.hashGroupDuplicatesToShow=a}return{templateUrl:"static/html/directives/search-result.html",require:"^titleGroup",scope:{titleGroup:"<",showDuplicates:"<",selected:"<",rowIndex:"<"},controller:["$scope","$element","$attrs",e],multiElement:!0}}function otherColumns(e,t,n,r){function o(e,t,n,o,a){function i(n){if(0!=n.has_nfo){var r=new URI("internalapi/getnfo");return r.addQuery("searchresultid",n.searchResultId),t.get(r.toString()).then(function(t){t.data.has_nfo?e.openModal("lg",t.data.nfo):angular.isUndefined(n.message)?o.info("No NFO available"):o.error(n.message)})}}function s(e,t){var r=n.open({template:'<pre class="nfo"><span ng-bind-html="nfo"></span></pre>',controller:NfoModalInstanceCtrl,size:e,resolve:{nfo:function(){return t}}});r.result.then()}function l(e){r.location.href=e.link}e.showDetailsDl=a.getUserInfos().maySeeDetailsDl,e.showNfo=i,e.openModal=s,e.downloadNzb=l,e.getNfoTooltip=function(){return 1==e.result.has_nfo?"Show NFO":2==e.result.has_nfo?"Try to load NFO (may not be available)":"No NFO available"}}return o.$inject=["$scope","$http","$uibModal","growl","HydraAuthService"],{scope:{result:"<"},multiElement:!0,link:function(r,o,a){e.get("static/html/directives/search-result-non-title-columns.html",{cache:t}).success(function(e){o.replaceWith(n(e)(r))})},controller:o}}function NfoModalInstanceCtrl(e,t,n){e.nfo=n,e.ok=function(){t.close(e.selected.item)},e.cancel=function(){t.dismiss()}}function onFinishRender(e){function t(t,n,r){t.$last===!0&&e(function(){t.$evalAsync(r.onFinishRender)})}return{link:t}}function hydralog(){function e(e,t,n,r,o){function a(){return t.get("internalapi/getlogs").success(function(t){e.log=n.trustAsHtml(t.log)})}function i(){e.tailInterval=r(function(){a(),e.doTailLog&&e.scrollToBottom()},5e3)}e.tailInterval=null,e.doUpdateLog=null!=o.get("doUpdateLog")?o.get("doUpdateLog"):!1,e.doTailLog=null!=o.get("doTailLog")?o.get("doTailLog"):!1,e.logPromise=a(),e.scrollToBottom=function(){document.getElementById("logfile").scrollTop=1e7,document.getElementById("logfile").scrollTop=100001e3},e.update=function(){a(),e.scrollToBottom()},e.toggleUpdate=function(){e.doUpdateLog?i():null!=e.tailInterval&&(console.log("Cancelling"),r.cancel(e.tailInterval),o.set("doTailLog",!1),e.doTailLog=!1),o.set("doUpdateLog",e.doUpdateLog)},e.toggleTailLog=function(){o.set("doTailLog",e.doTailLog)},e.doUpdateLog&&i(),e.$on("$destroy",function(){null!==e.tailInterval&&r.cancel(e.tailInterval)})}return e.$inject=["$scope","$http","$sce","$interval","localStorageService"],{templateUrl:"static/html/directives/log.html",controller:e}}function indexerInput(){function e(e){e.isFocused=!1,e.onFocus=function(){e.isFocused=!0},e.onBlur=function(){e.isFocused=!1}}return e.$inject=["$scope"],{templateUrl:"static/html/directives/indexer-input.html",scope:{indexer:"=",model:"=",onClick:"="},replace:!0,controller:e}}function focusOn(){function e(e,t,n){e.$on("focusOn",function(e,r){r===n.focusOn&&t[0].focus()})}return e}function duplicateGroup(){function e(e,t){function n(){return e.duplicates.slice(1)}function r(e,t,n){return e>=t&&n>=e||t>=e&&e>=n}function o(e,t,n){var r=_.indexOf(e,t);r>-1?e.splice(r,1):n||e.push(t)}e.internalRowIndex=Number(e.internalRowIndex),e.rowIndex=Number(e.rowIndex),e.titlesExpanded=!1,e.duplicatesExpanded=!1,e.foo={duplicatesDisplayed:null!=t.get("duplicatesDisplayed")?t.get("duplicatesDisplayed"):!1},e.duplicatesToShow=n,e.toggleTitleExpansion=function(){e.titlesExpanded=!e.titlesExpanded,e.$emit("toggleTitleExpansion",e.titlesExpanded)},e.toggleDuplicateExpansion=function(){e.duplicatesExpanded=!e.duplicatesExpanded},e.$on("invertSelection",function(){for(var t=0;t<e.duplicates.length;t++)e.duplicatesExpanded?o(e.selected,e.duplicates[t]):t>0?o(e.selected,e.duplicates[t],!0):o(e.selected,e.duplicates[t])}),e.$on("duplicatesDisplayed",function(t,n){e.foo.duplicatesDisplayed=n}),e.clickCheckbox=function(t){var n=1e3*e.rowIndex+100*e.internalRowIndex+Number(t.currentTarget.dataset.checkboxIndex);console.log(n),e.$emit("checkboxClicked",t,n,t.currentTarget.checked)},e.$on("shiftClick",function(t,n,o,a){var i=1e3*e.rowIndex+100*e.internalRowIndex;if(r(i,n,o))for(var s=0;s<e.duplicates.length;s++)if(r(i+s,n,o)&&(0==s||e.duplicatesExpanded)){console.log("Indirectly clicked row with global index "+(i+s)+" setting new checkbox value to "+a);var l=_.indexOf(e.selected,e.duplicates[s]);-1==l&&a?(console.log("Adding to selection"),e.selected.push(e.duplicates[s])):l>-1&&!a&&(e.selected.splice(l,1),console.log("Removing from selection"))}})}return e.$inject=["$scope","localStorageService"],{templateUrl:"static/html/directives/duplicate-group.html",scope:{duplicates:"<",selected:"=",isFirstRow:"<",rowIndex:"<",displayTitleToggle:"<",internalRowIndex:"@"},controller:e}}function downloadNzbzipButton(){function e(e,t,n){e.download=function(){if(angular.isUndefined(e.searchResults)||0==e.searchResults.length)t.info("You should select at least one result...");else{var r,o=_.map(e.searchResults,function(e){return e.searchResultId}),a="getnzbzip?searchresultids="+o.join("|");r=angular.isDefined(e.searchTitle)?" for "+e.searchTitle:"";var i="NZBHydra NZBs"+r+".zip";n.downloadFile(a,i)}}}return e.$inject=["$scope","growl","FileDownloadService"],{templateUrl:"static/html/directives/download-nzbzip-button.html",require:["^searchResults"],scope:{searchResults:"<",searchTitle:"<"},controller:e}}function downloadNzbsButton(){function e(e,t,n){e.downloaders=t.getEnabledDownloaders(),e.download=function(r){if(angular.isUndefined(e.searchResults)||0==e.searchResults.length)n.info("You should select at least one result...");else{var o=_.map(e.searchResults,function(e){return e.searchResultId});t.download(r,o).then(function(e){e.data.success?n.info("Successfully added "+e.data.added+" of "+e.data.of+" NZBs"):n.error("Error while adding NZBs")},function(){n.error("Error while adding NZBs")})}}}return e.$inject=["$scope","NzbDownloadService","growl"],{templateUrl:"static/html/directives/download-nzbs-button.html",require:["^searchResults"],scope:{searchResults:"<"},controller:e}}function columnFilterWrapper(){function e(e){var t=this;t.open=!1,t.isActive=!1,t.toggle=function(){t.open=!t.open,t.open&&e.$broadcast("opened")},e.$on("filter",function(e,n,r,o){t.open=!1,t.isActive=o})}return e.$inject=["$scope"],{restrict:"E",templateUrl:"static/html/dataTable/columnFilterOuter.html",transclude:!0,controllerAs:"columnFilterWrapperCtrl",scope:!0,bindToController:!0,controller:e}}function freetextFilter(){function e(e,t){e.data={},e.$on("opened",function(){t("freetext-filter-input")}),e.onKeypress=function(t){13===t.which&&e.$emit("filter",e.column,{filter:e.data.filter,filtertype:"freetext"},angular.isDefined(e.data.filter)&&e.data.filter.length>0)}}return e.$inject=["$scope","focus"],{template:"<ng-include src=\"'static/html/dataTable/columnFilterFreetext.html'\"/>",require:"^columnFilterWrapper",controllerAs:"innerController",scope:{column:"@"},controller:e}}function checkboxesFilter(){function e(e){e.selected={entries:[]},e.preselect&&(e.selected.entries=e.entries.slice()),e.invert=function(){e.selected.entries=_.difference(e.entries,e.selected.entries)},e.apply=function(){console.log(e.selected);var t=e.selected.entries.length<e.entries.length;e.$emit("filter",e.column,{filter:_.pluck(e.selected.entries,"id"),filtertype:"checkboxes",isBoolean:e.isBoolean},t)}}return e.$inject=["$scope"],{template:"<ng-include src=\"'static/html/dataTable/columnFilterCheckboxes.html'\"/>",controllerAs:"checkboxesFilterController",scope:{column:"@",entries:"<",preselect:"<",showInvert:"<",isBoolean:"<"},controller:e}}function booleanFilter(){function e(e){e.selected={value:e.options[e.preselect].value},e.apply=function(){console.log(e.selected),e.$emit("filter",e.column,{filter:e.selected.value,filtertype:"boolean"},e.selected.value!=e.options[0].value)}}return e.$inject=["$scope"],{template:"<ng-include src=\"'static/html/dataTable/columnFilterBoolean.html'\"/>",controllerAs:"booleanFilterController",scope:{column:"@",options:"<",preselect:"@"},controller:e}}function timeFilter(){function e(e){e.dateOptions={dateDisabled:!1,formatYear:"yy",startingDay:1},e.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],e.format=e.formats[0],e.altInputFormats=["M!/d!/yyyy"],e.openAfter=function(){e.after.opened=!0},e.openBefore=function(){e.before.opened=!0},e.after={opened:!1},e.before={opened:!1},e.apply=function(){var t=e.selected.beforeDate||e.selected.afterDate;e.$emit("filter",e.column,{filter:{after:e.selected.afterDate,before:e.selected.beforeDate},filtertype:"time"},t)}}return e.$inject=["$scope"],{template:"<ng-include src=\"'static/html/dataTable/columnFilterTime.html'\"/>",scope:{column:"@",selected:"<"},controller:e}}function columnSortable(){function e(e){angular.isUndefined(e.sortMode)&&(e.sortMode=0),e.$on("newSortColumn",function(t,n){n!=e.column&&(e.sortMode=0)}),e.sort=function(){e.sortMode=(e.sortMode+1)%3,e.$emit("sort",e.column,e.sortMode)}}return e.$inject=["$scope"],{restrict:"E",templateUrl:"static/html/dataTable/columnSortable.html",transclude:!0,scope:{sortMode:"@",column:"@"},controller:e}}function connectionTest(){function e(e){function t(){angular.element(r).removeClass("btn-default"),angular.element(r).removeClass("btn-danger"),angular.element(r).addClass("btn-success")}function n(){angular.element(r).removeClass("btn-default"),angular.element(r).removeClass("btn-success"),angular.element(r).addClass("btn-danger")}e.message="",console.log(e);var r="#button-test-connection",o="#message-test-connection";e.testConnection=function(){angular.element(r).addClass("glyphicon-refresh-animate");var a,i,s=angular.injector(["ng"]),l=s.get("$http");"downloader"==e.type?(a="internalapi/test_downloader",i={name:e.downloader,username:e.data.username,password:e.data.password},"sabnzbd"==e.downloader?(i.apikey=e.data.apikey,i.url=e.data.url):(i.host=e.data.host,i.port=e.data.port,i.ssl=e.data.ssl)):"newznab"==e.data.type&&(a="internalapi/test_newznab",i={host:e.data.host,apikey:e.data.apikey},angular.isDefined(e.data.username)&&(i.username=e.data.username,i.password=e.data.password)),l.get(a,{params:i}).success(function(e){e.result?(angular.element(o).text(""),t()):(angular.element(o).text(e.message),n())}).error(function(){angular.element(o).text(result.message),n()})["finally"](function(){angular.element(r).removeClass("glyphicon-refresh-animate")})}}return e.$inject=["$scope"],{templateUrl:"static/html/directives/connection-test.html",require:["^type","^data"],scope:{type:"=",id:"=",data:"=",downloader:"="},controller:e}}function cfgFormEntry(){return{templateUrl:"static/html/directives/cfg-form-entry.html",require:["^title","^cfg"],scope:{title:"@",cfg:"=",help:"@",type:"@?",options:"=?"},controller:["$scope","$element","$attrs",function(e,t,n){e.type=angular.isDefined(e.type)?e.type:"text",e.options=angular.isDefined(e.type)?e.$eval(n.options):[]}]}}function hydrabackup(){function e(e,t,n,r,o,a,i){e.refreshBackupList=function(){t.getBackupsList().then(function(t){e.backups=t})},e.refreshBackupList(),e.uploadActive=!1,e.createAndDownloadBackupFile=function(){r.downloadFile("internalapi/getbackup","nzbhydra-backup-"+moment().format("YYYY-MM-DD-HH-mm")+".zip")},e.uploadBackupFile=function(t,r){o.specificallyHandled(function(){console.log("Hallo"),e.file=t,e.errFile=r&&r[0],t&&(e.uploadActive=!0,t.upload=n.upload({url:"internalapi/restorebackup",data:{content:t}}),t.upload.then(function(n){e.uploadActive=!1,t.result=n.data,i.restart("Restore successful.")},function(t){e.uploadActive=!1,a.error(t.data)},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total)),t.loaded=Math.floor(e.loaded/1024),t.total=Math.floor(e.total/1024)}))})},e.restoreFromFile=function(e){t.restoreFromFile(e).then(function(){i.restart("Restore successful.")},function(e){a.error(e.data)})}}return e.$inject=["$scope","BackupService","Upload","FileDownloadService","RequestsErrorHandler","growl","RestartService"],{templateUrl:"static/html/directives/backup.html",controller:e}}function addableNzbs(){function e(e,t){e.downloaders=_.filter(t.getEnabledDownloaders(),function(t){return"nzb"!=e.downloadType?t.downloadType==e.downloadType:!0})}return e.$inject=["$scope","NzbDownloadService"],{templateUrl:"static/html/directives/addable-nzbs.html",require:["^searchResultId"],scope:{searchResultId:"<",downloadType:"<"},controller:e}}function addableNzb(){function e(e,t,n){e.downloader.iconCssClass?e.cssClass="fa fa-"+e.downloader.iconCssClass.replace("fa-","").replace("fa ",""):e.cssClass="sabnzbd"==e.downloader.type?"sabnzbd":"nzbget",e.add=function(){e.cssClass="nzb-spinning",t.download(e.downloader,[e.searchResultId]).then(function(t){t.data.success?e.cssClass="sabnzbd"==e.downloader.type?"sabnzbd-success":"nzbget-success":(e.cssClass="sabnzbd"==e.downloader.type?"sabnzbd-error":"nzbget-error",n.error("Unable to add NZB. Make sure the downloader is running and properly configured."))},function(){e.cssClass="sabnzbd"==e.downloader.type?"sabnzbd-error":"nzbget-error",n.error("An unexpected error occurred while trying to contact NZB Hydra or add the NZB.")})}}return e.$inject=["$scope","NzbDownloadService","growl"],{templateUrl:"static/html/directives/addable-nzb.html",scope:{searchResultId:"<",downloader:"<"},controller:e}}function UpdateService(e,t,n,r){function o(){return e.get("internalapi/get_versions").then(function(e){return c=e.data.currentVersion,u=e.data.repVersion,d=e.data.updateAvailable,e})}function a(){return e.get("internalapi/get_changelog",{currentVersion:c,repVersion:u}).then(function(e){return p=e.data.changelog,e})}function i(){return e.get("internalapi/get_version_history").then(function(e){return h=e.data.versionHistory,e})}function s(e){var t=angular.injector(["ng","ui.bootstrap"]),n=t.get("$uibModal"),r={size:"lg",templateUrl:"static/html/changelog.html",resolve:{changelog:function(){return e}},controller:function(e,t,n,r){r=t.trustAsHtml(r),e.changelog=r,console.log(r),e.ok=function(){n.dismiss()}}},o=n.open(r);o.result.then()}function l(){n.start("Updating. Please stand by..."),e.get("internalapi/update").then(function(e){e.data.success?r.restart("Update complete.",15):(n.reset(),t.info("An error occurred while updating. Please check the logs."))},function(){n.reset(),t.info("An error occurred while updating. Please check the logs.")})}var c,u,d,p,h;return{update:l,showChanges:s,getVersions:o,getChangelog:a,getVersionHistory:i}}function UpdateFooterController(e,t,n){function r(){e.checked=!0,t.getVersions().then(function(t){e.currentVersion=t.data.currentVersion,e.repVersion=t.data.repVersion,e.updateAvailable=t.data.updateAvailable,e.changelog=t.data.changelog})}e.updateAvailable=!1,e.checked=!1,e.mayUpdate=n.getUserInfos().maySeeAdmin,e.$on("user:loggedIn",function(){n.getUserInfos().maySeeAdmin&&!e.checked&&r()}),e.mayUpdate&&r(),e.update=function(){t.update()},e.showChangelog=function(){t.showChanges(e.changelog)}}function SystemController(e,t,n,r,o,a,i,s,l){e.activeTab=n,e.shutdown=function(){l.shutdown().then(function(){o.info("Shutdown initiated. Cya!")},function(){o.info("Unable to send shutdown command.")})},e.restart=function(){a.restart()},e.deleteLogAndDatabase=function(){i.open("Delete log and db","Are you absolutely sure you want to delete your database and log files? Hydra will restart to do that.",{yes:{onYes:function(){l.deleteLogAndDb(),a.countdown()},text:"Yes, delete log and database"},no:{onCancel:function(){},text:"Nah"}})},e.forceUpdate=function(){s.update()},e.allTabs=[{active:!1,state:"root.system.control",name:"Control"},{active:!1,state:"root.system.updates",name:"Updates"},{active:!1,state:"root.system.log",name:"Log"},{active:!1,state:"root.system.backup",name:"Backup"},{active:!1,state:"root.system.bugreport",name:"Bugreport"},{active:!1,state:"root.system.about",name:"About"}],e.goToSystemState=function(n){t.go(e.allTabs[n].state,{activeTab:n},{inherit:!1,notify:!0,reload:!0})},e.downloadDebuggingInfos=function(){r({method:"GET",url:"internalapi/getdebugginginfos",responseType:"arraybuffer"}).success(function(e,t,n,r){var o=document.createElement("a"),a=new Blob([e],{type:"application/octet-stream"});o.href=URL.createObjectURL(a);var i="nzbhydra-debuginfo-"+moment().format("YYYY-MM-DD-HH-mm")+".zip";o.download=i,document.body.appendChild(o),o.click(),document.body.removeChild(o)}).error(function(e,t,n,r){console.log("Error:"+t)})}}function StatsService(e){function t(t,n){return e.get("internalapi/getstats",{params:{after:t,before:n}}).success(function(e){return e.data})}function n(t,n,r,o){var a={page:t,limit:n,filterModel:r};return angular.isUndefined(t)&&(a.page=1),angular.isUndefined(n)&&(a.limit=100),angular.isUndefined(r)&&(a.filterModel={}),angular.isUndefined(o)||(a.sortModel=o),e.post("internalapi/getnzbdownloads",a).success(function(e){return{nzbDownloads:e.nzbDownloads,totalDownloads:e.totalDownloads}})}return{get:t,getDownloadHistory:n}}function StatsController(e,t,n,r){function o(){r.start("Updating stats...");var t=null!=e.afterDate?Math.floor(e.afterDate.getTime()/1e3):null,o=null!=e.beforeDate?Math.floor(e.beforeDate.getTime()/1e3):null;n.get(t,o).then(function(t){e.setStats(t)}),r.reset()}function a(e,t,n,r,o,a){return{options:{chart:{type:e,height:350,margin:{top:20,right:20,bottom:100,left:50},x:function(e){return e[n]},y:function(e){return e[r]},showValues:!0,valueFormat:function(e){return e},color:function(){return"red"},showControls:!1,showLegend:!1,duration:100,xAxis:{axisLabel:o,tickFormat:function(e){return e},rotateLabels:30,showMaxMin:!1,color:function(){return"white"}},yAxis:{axisLabel:a,axisLabelDistance:-10,tickFormat:function(e){return e}},tooltip:{enabled:!1},zoom:{enabled:!0,scaleExtent:[1,10],useFixedDomain:!1,useNiceScale:!1,horizontalOff:!1,verticalOff:!0,unzoomEventType:"dblclick.zoom"}}},data:[{key:"doesntmatter",bar:!0,values:t}]}}function i(){return{options:{chart:{type:"multiBarChart",height:350,margin:{top:20,right:20,bottom:100,left:45},clipEdge:!0,duration:500,stacked:!1,reduceXTicks:!1,showValues:!0,tooltip:{enabled:!0,valueFormatter:function(e){return e+"%"}},showControls:!1,xAxis:{axisLabel:"",showMaxMin:!1,rotateLabels:30,axisLabelDistance:30,tickFormat:function(e){return e}},yAxis:{axisLabel:"Share (%)",axisLabelDistance:-20,tickFormat:function(e){return e}}}},data:[{key:"Results",values:_.map(e.avgIndexerSearchResultsShares,function(e){return{series:0,y:e.avgResultsShare,x:e.name}})},{key:"Unique results",values:_.map(e.avgIndexerSearchResultsShares,function(e){return{series:1,y:e.avgUniqueResults,x:e.name}})}]}}e.dateOptions={dateDisabled:!1,formatYear:"yy",startingDay:1};var s=!0,l=!0;e.afterDate=moment().subtract(30,"days").toDate(),e.beforeDate=moment().toDate(),o(),e.openAfter=function(){e.after.opened=!0},e.openBefore=function(){e.before.opened=!0},e.after={opened:!1},e.before={opened:!1},e.$watch("beforeDate",function(){l?l=!1:o()}),e.$watch("afterDate",function(){s?s=!1:o()}),e.onKeypress=function(e){13===e.which&&o()},e.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],e.format=e.formats[0],e.altInputFormats=["M!/d!/yyyy"],e.setStats=function(n){n=n.data,e.nzbDownloads=null,e.avgResponseTimes=n.avgResponseTimes,e.avgIndexerSearchResultsShares=n.avgIndexerSearchResultsShares,e.avgIndexerAccessSuccesses=n.avgIndexerAccessSuccesses,e.indexerDownloadShares=n.indexerDownloadShares,e.downloadsPerHourOfDay=n.timeBasedDownloadStats.perHourOfDay,e.downloadsPerDayOfWeek=n.timeBasedDownloadStats.perDayOfWeek,e.searchesPerHourOfDay=n.timeBasedSearchStats.perHourOfDay,e.searchesPerDayOfWeek=n.timeBasedSearchStats.perDayOfWeek;var r=e.avgResponseTimes.length;e.avgResponseTimesChart=a("multiBarHorizontalChart",e.avgResponseTimes,"name","avgResponseTime","","Response time"),e.avgResponseTimesChart.options.chart.margin.left=100,e.avgResponseTimesChart.options.chart.yAxis.rotateLabels=-30;var o=Math.max(30*r,350);e.avgResponseTimesChart.options.chart.height=o,e.resultsSharesChart=i();var s=30;r>30&&(s=70),e.resultsSharesChart.options.chart.xAxis.rotateLabels=s,e.resultsSharesChart.options.chart.height=o,e.downloadsPerHourOfDayChart=a("discreteBarChart",e.downloadsPerHourOfDay,"hour","count","Hour of day","Downloads"),e.downloadsPerHourOfDayChart.options.chart.xAxis.rotateLabels=0,e.downloadsPerDayOfWeekChart=a("discreteBarChart",e.downloadsPerDayOfWeek,"day","count","Day of week","Downloads"),e.downloadsPerDayOfWeekChart.options.chart.xAxis.rotateLabels=0,e.searchesPerHourOfDayChart=a("discreteBarChart",e.searchesPerHourOfDay,"hour","count","Hour of day","Searches"),e.searchesPerHourOfDayChart.options.chart.xAxis.rotateLabels=0,e.searchesPerDayOfWeekChart=a("discreteBarChart",e.searchesPerDayOfWeek,"day","count","Day of week","Searches"),e.searchesPerDayOfWeekChart.options.chart.xAxis.rotateLabels=0,e.indexerDownloadSharesChart={options:{chart:{type:"pieChart",height:500,x:function(e){return e.name},y:function(e){return e.share},showLabels:!0,duration:500,labelThreshold:.01,labelSunbeamLayout:!0,tooltip:{valueFormatter:function(e,n){return t("number")(e,2)+"%"}},legend:{margin:{top:5,right:35,bottom:5,left:0}}}},data:e.indexerDownloadShares},e.indexerDownloadSharesChart.options.chart.height=Math.min(Math.max(40*r,350),900)}}function SearchService(e){function t(t,n,o,i,s,l,c,u,d,p,h,f,m,g,y){var b;return t.indexOf("Movies")>-1||0==t.indexOf("20")||"movie"==y?(b=new URI("internalapi/moviesearch"),angular.isDefined(o)?b.addQuery("tmdbid",o):angular.isDefined(i)?b.addQuery("imdbid",i):b.addQuery("query",n)):t.indexOf("TV")>-1||0==t.indexOf("50")||"tvsearch"==y?(b=new URI("internalapi/tvsearch"),angular.isDefined(l)&&b.addQuery("tvdbid",l),angular.isDefined(c)?b.addQuery("rid",c):b.addQuery("query",n),angular.isDefined(u)&&b.addQuery("season",u),angular.isDefined(d)&&b.addQuery("episode",d)):(b=new URI("internalapi/search"),b.addQuery("query",n)),angular.isDefined(s)&&b.addQuery("title",s),_.isNumber(p)&&b.addQuery("minsize",p),_.isNumber(h)&&b.addQuery("maxsize",h),_.isNumber(f)&&b.addQuery("minage",f),_.isNumber(m)&&b.addQuery("maxage",m),angular.isUndefined(g)||b.addQuery("indexers",decodeURIComponent(g)),b.addQuery("category",t),a=b,e.get(b.toString()).then(r)}function n(t,n){return a.removeQuery("offset"),a.addQuery("offset",t),a.addQuery("loadAll",n?!0:!1),e.get(a.toString()).then(r)}function r(e){var t=e.data.results,n=e.data.indexersearches,r=e.data.total,o=e.data.rejected,a=t.length;return _.each(n,function(e){e.did_search&&(e.averageResponseTime=_.reduce(e.apiAccesses,function(e,t){return e+t.response_time},0),e.averageResponseTime=e.averageResponseTime/e.apiAccesses.length)}),i={results:t,indexersearches:n,total:r,resultsCount:a,rejected:o}}function o(){return i}var a,i;return{search:t,getLastResults:o,loadMore:n}}function sumRejected(e){return _.reduce(e,function(e,t){return e+t[1]},0)}function SearchResultsController(e,t,n,r,o,a,i,s,l){function c(e){return e[0][t.sortPredicate]}function u(e){return e[0][0].searchResultId}function d(e){var t=n.defer();return o.start(e),r(function(){t.resolve()},100),t.promise}function p(e,n){e==t.sortPredicate?t.sortReversed=!t.sortReversed:t.sortReversed=n,t.sortPredicate=e,d("Sorting / filtering...").then(function(){t.filteredResults=f(t.results),o.reset(),i.set("sorting",{predicate:e,reversed:t.sortReversed})})}function h(e){var n=!0;return n=n&&t.titleFilter&&e.title.toLowerCase().indexOf(t.titleFilter)>-1,n=n&&t.minSizeFilter&&1024*t.minSizeFilter*1024<e.size,n=n&&t.maxSizeFilter&&1024*t.maxSizeFilter*1024>e.size}function f(e,n,r,o,i,s){function l(e){var a=!0;if(a=a&&(!_.isNumber(i)||e.size/1024/1024>=i)&&(!_.isNumber(s)||e.size/1024/1024<=s)&&(!_.isNumber(r)||e.age_days>=Number(r))&&(!_.isNumber(o)||e.age_days<=Number(o)),a&&n){var l=n.toLowerCase().split(" ");a=_.every(l,function(t){return e.title.toLowerCase().indexOf(t)>-1})}return a||t.countFilteredOut++,a}function c(e){return t.indexerDisplayState[e.indexer.toLowerCase()]}function u(e){return e.title.toLowerCase().replace(/[\s\-\._]/gi,"")}function d(e){function n(e){var n=_.sortBy(e,function(e){var n;return n="grabs"==t.sortPredicate?angular.isDefined(e.grabs)?e.grabs:0:e[t.sortPredicate],t.sortReversed?-n:n});return n=_.sortBy(n,function(e){return-1*e.indexerscore})}function r(e){if("grabs"==t.sortPredicate)n=angular.isDefined(e[0].grabs)?e[0].grabs:0;else var n=e[0][t.sortPredicate];return t.sortReversed?-n:n}return _.chain(e).groupBy("hash").map(n).sortBy(r).value()}function p(e){var n;return n="title"==t.sortPredicate?e[0][0].title.toLowerCase():"grabs"==t.sortPredicate?angular.isDefined(e[0][0].grabs)?e[0][0].grabs:0:e[0][0][t.sortPredicate]}t.countFilteredOut=0;var h=_.chain(e).filter(l).filter(c).groupBy(u).map(d).sortBy(p).value();return t.sortReversed&&(h=h.reverse()),t.countFilteredOut>0&&a.info("Filtered "+t.countFilteredOut+" of the retrieved results"),t.lastClicked=null,h}function m(){o.reset()}function g(e){d(e?"Loading all results...":"Loading more results...").then(function(){s.loadMore(t.resultsCount,e).then(function(e){t.results=t.results.concat(e.results),t.filteredResults=f(t.results),t.total=e.total,t.rejected=e.rejected,t.countRejected=sumRejected(t.rejected),t.resultsCount+=e.resultsCount,m()})})}function y(e){t.indexerDisplayState[e.toLowerCase()]=t.indexerDisplayState[e.toLowerCase()],d("Filtering. Sorry...").then(function(){t.filteredResults=f(t.results)}).then(function(){m()})}function b(){return t.results.length}if(null!=i.get("sorting")){var v=i.get("sorting");t.sortPredicate=v.predicate,t.sortReversed=v.reversed}else t.sortPredicate="epoch",t.sortReversed=!0;t.limitTo=100,t.offset=0,t.indexersearches=_.sortBy(s.getLastResults().indexersearches,function(e){return e.indexer.toLowerCase()}),t.indexerDisplayState=[],t.indexerResultsInfo={},t.groupExpanded={},t.selected=[],e.title?t.searchTitle=e.title:e.query?t.searchTitle=e.query:t.searchTitle=void 0,t.selectedIds=_.map(t.selected,function(e){return e.searchResultId}),t.lastClicked=null,t.lastClickedValue=null,t.foo={indexerStatusesExpanded:null!=i.get("indexerStatusesExpanded")?i.get("indexerStatusesExpanded"):!1,duplicatesDisplayed:null!=i.get("duplicatesDisplayed")?i.get("duplicatesDisplayed"):!1},t.countFilteredOut=0,_.forEach(t.indexersearches,function(e){t.indexerDisplayState[e.indexer.toLowerCase()]=!0}),_.forEach(t.indexersearches,function(e){t.indexerResultsInfo[e.indexer.toLowerCase()]={loadedResults:e.loaded_results}}),t.results=s.getLastResults().results,t.total=s.getLastResults().total,t.resultsCount=s.getLastResults().resultsCount,t.rejected=s.getLastResults().rejected,t.countRejected=sumRejected(t.rejected),t.filteredResults=f(t.results),t.$emit("searchResultsShown"),m(),t.firstResultPredicate=c,t.groupId=u,t.setSorting=p,t.inlineFilter=h,t.$on("searchInputChanged",function(e,n,r,o,a,i){t.filteredResults=f(t.results,n,r,o,a,i)}),t.resort=function(){},t.toggleTitlegroupExpand=function(e){t.groupExpanded[e[0][0].title]=!t.groupExpanded[e[0][0].title],t.groupExpanded[e[0][0].hash]=!t.groupExpanded[e[0][0].hash]},t.stopBlocking=m,t.loadMore=g,t.toggleIndexerDisplay=y,t.countResults=b,t.invertSelection=function(){t.$broadcast("invertSelection")},t.toggleIndexerStatuses=function(){t.foo.indexerStatusesExpanded=!t.foo.indexerStatusesExpanded,i.set("indexerStatusesExpanded",t.foo.indexerStatusesExpanded)},t.toggleDuplicatesDisplayed=function(){i.set("duplicatesDisplayed",t.foo.duplicatesDisplayed),t.$broadcast("duplicatesDisplayed",t.foo.duplicatesDisplayed)},t.$on("checkboxClicked",function(e,n,r,o){n.shiftKey&&null!=t.lastClicked&&t.$broadcast("shiftClick",Number(t.lastClicked),Number(r),Number(t.lastClickedValue)),t.lastClicked=r,t.lastClickedValue=o}),t.filterRejectedZero=function(){return function(e){return e[1]>0}}}function SearchHistoryService(e,t){function n(){return t.post("internalapi/getsearchrequestsforsearching").success(function(e){return{searchRequests:e.searchRequests,totalRequests:e.totalRequests}})}function r(e,n,r,o,a,i){var s={page:e,limit:n,filterModel:r,distinct:a,onlyCurrentUser:i};return angular.isUndefined(e)&&(s.page=1),angular.isUndefined(n)&&(s.limit=100),angular.isUndefined(r)&&(s.filterModel={}),angular.isUndefined(o)||(s.sortModel=o),t.post("internalapi/getsearchrequests",s).success(function(e){return{searchRequests:e.searchRequests,totalRequests:e.totalRequests}})}function o(t,n,r,o,a){var i=[];if(r&&t.query&&i.push("Query: "+t.query),t.title&&a)i.push('<span class="history-title">Title: </span>'+t.title);else if(t.movietitle&&a)i.push('<span class="history-title">Title: </span>'+t.movietitle);else if(t.tvtitle&&a)i.push('<span class="history-title">Title: </span>'+t.tvtitle);else if(t.identifier_key){var s,l;"imdbid"==t.identifier_key?(l="IMDB ID",s="https://www.imdb.com/title/tt"):"tvdbid"==t.identifier_key?(l="TVDB ID",s="https://thetvdb.com/?tab=series&id="):"rid"==t.identifier_key?(l="TVRage ID",s="internalapi/redirect_rid?rid="):"tmdb"==t.identifier_key&&(l="TMDV ID",s="https://www.themoviedb.org/movie/"),s+=t.identifier_value,s=e("dereferer")(s),n?i.push('<span class="history-title">'+l+': </span><a target="_blank" href="'+s+'">'+t.identifier_value+"</a>"):i.push('<span class="history-title">'+l+": </span>"+t.identifier_value)}return t.season&&i.push('<span class="history-title">Season: </span>'+t.season),t.episode&&i.push('<span class="history-title">Episode: </span>'+t.episode),t.author&&i.push('<span class="history-title">Author: </span>'+t.author),0==i.length&&o&&(i=['<span class="history-title">Empty search</span>']),i.join(", ")}function a(e){var t={};return t.mode="search","imdbid"==e.identifier_key?(t.mode="movie",t.imdbid=e.identifier_value):("tvdbid"==e.identifier_key||"rid"==e.identifier_key)&&(t.mode="tvsearch","rid"==e.identifier_key?t.rid=e.identifier_value:t.tvdbid=e.identifier_value,
""!=e.season&&(t.season=e.season),""!=e.episode&&(t.episode=e.episode)),""!=e.query&&(t.query=e.query),null!=e.movietitle&&(t.title=e.movietitle),null!=e.tvtitle&&(t.title=e.tvtitle),e.category&&(t.category=e.category),t.category=e.category,t}return{getSearchHistory:r,getSearchHistoryForSearching:n,formatRequest:o,getStateParamsForRepeatedSearch:a}}function SearchHistoryController(e,t,n,r,o,a,i){e.limit=100,e.pagination={current:1},e.sortModel={column:"time",sortMode:2},e.filterModel={},e.categoriesForFiltering=[],_.forEach(r.getSafe().categories,function(t){e.categoriesForFiltering.push({label:t.pretty,id:t.pretty})}),e.preselectedTimeInterval={beforeDate:null,afterDate:null},e.accessOptionsForFiltering=[{label:"All",value:"all"},{label:"API",value:!1},{label:"Internal",value:!0}],e.searchRequests=o.data.searchRequests,e.totalRequests=o.data.totalRequests,e.update=function(){n.getSearchHistory(e.pagination.current,e.limit,e.filterModel,e.sortModel).then(function(t){e.searchRequests=t.data.searchRequests,e.totalRequests=t.data.totalRequests})},e.$on("sort",function(t,n,r){0==r&&(n="time",r=2),e.sortModel={column:n,sortMode:r},e.$broadcast("newSortColumn",n),e.update()}),e.$on("filter",function(t,n,r,o){r.filter?e.filterModel[n]=r:delete e.filterModel[n],e.update()}),e.openSearch=function(e){var n={};"imdbid"==e.identifier_key?n.imdbid=e.identifier_value:("tvdbid"==e.identifier_key||"rid"==e.identifier_key)&&("rid"==e.identifier_key?n.rid=e.identifier_value:n.tvdbid=e.identifier_value,""!=e.season&&(n.season=e.season),""!=e.episode&&(n.episode=e.episode)),""!=e.query&&(n.query=e.query),"tv"==e.type?n.mode="tvsearch":"movie"==e.type?n.mode="movie":n.mode="search",null!=e.movietitle&&(n.title=e.movietitle),null!=e.tvtitle&&(n.title=e.tvtitle),e.category&&(n.category=e.category),n.category=e.category,t.go("root.search",n,{inherit:!1})},e.formatQuery=function(e){return null!=e.movietitle?e.movietitle:null!=e.tvtitle?e.tvtitle:e.query||e.identifier_key||e.season||e.episode?e.query:"Update query"},e.formatAdditional=function(e){var t=[];if(e.identifier_key){var n,r;"imdbid"==e.identifier_key?(r="IMDB ID",n="https://www.imdb.com/title/tt"):"tvdbid"==e.identifier_key?(r="TVDB ID",n="https://thetvdb.com/?tab=series&id="):"rid"==e.identifier_key?(r="TVRage ID",n="internalapi/redirect_rid?rid="):"tmdb"==e.identifier_key&&(r="TMDV ID",n="https://www.themoviedb.org/movie/"),n+=e.identifier_value,n=i("dereferer")(n),t.push(r+': <a target="_blank" href="'+n+'">'+e.identifier_value+"</a>")}return e.season&&t.push("Season: "+e.season),e.episode&&t.push("Episode: "+e.episode),e.author&&t.push("Author: "+e.author),e.title&&t.push("Title: "+e.title),a.trustAsHtml(t.join(", "))}}function SearchController(e,t,n,r,o,a,i,s,l,c,u,d,p,h,f,m,g){function y(e){return _.isUndefined(e)||_.isNaN(e)||""==e?void 0:(e=parseInt(e),_.isNumber(e)?e:void 0)}function b(){var t=_.filter(e.availableIndexers).filter(function(e){return e.activated});return _.pluck(t,"name").join("|")}function v(t){return angular.isUndefined(e.indexers)?t.preselect:_.contains(e.indexers,t.name)}function w(){return _.chain(x.indexers).filter(function(t){return t.enabled&&t.showOnSearch&&(angular.isUndefined(t.categories)||0==t.categories.length||"all"==e.category.name||t.categories.indexOf(e.category.name)>-1)}).sortBy(function(e){return e.name.toLowerCase()}).map(function(e){return{name:e.name,activated:v(e),categories:e.categories}}).value()}function S(){g.getSearchHistoryForSearching().success(function(t){e.searchHistory=t.searchRequests})}e.mode=n.mode,e.categories=_.filter(p.getAll(),function(e){return e.mayBeSelected&&"internal"!=e.ignoreResults&&"always"!=e.ignoreResults}),angular.isDefined(n.category)&&n.category?e.category=p.getByName(n.category):e.category=p.getDefault(),e.category=_.isUndefined(n.category)||""==n.category?p.getDefault():p.getByName(n.category),e.tmdbid=n.tmdbid,e.tvdbid=n.tvdbid,e.imdbid=n.imdbid,e.rid=n.rid,e.title=n.title,e.season=n.season,e.episode=n.episode,e.query=n.query,e.minsize=y(n.minsize),e.maxsize=y(n.maxsize),e.minage=y(n.minage),e.maxage=y(n.maxage),!_.isUndefined(e.title)&&_.isUndefined(e.query),angular.isUndefined(n.indexers)||(e.indexers=decodeURIComponent(n.indexers).split("|")),e.showIndexers={},e.searchHistory=[];var x=u.getSafe();e.showIndexerSelection=d.getUserInfos().showIndexerSelection;var C=u.getSafe().firstStart<moment().subtract(3,"days").unix(),k=0==u.getSafe().pollShown&&C||1==u.getSafe().pollShown;if(k){var z;z=0==u.getSafe().pollShown?"Dear user, I would like to ask you to answer a short query about NZB Hydra. It is absolutely anonymous and will not take more than a couple of minutes. You would help me a lot!":"Dear user, thank you for answering my last survey. Unfortunately I'm an idiot and didn't know that SurveyMonkey would only show me the first 100 results. Please be so kind and answer the new survey :-)",m.open("User query",z,{yes:{onYes:function(){o.open(a("dereferer")("https://goo.gl/forms/F3PwtEor2krBxLcR2"),"_blank"),t.get("internalapi/pollshown",{params:{selection:1}}),u.getSafe().pollShown=2},text:"Yes, I want to help. Take me there."},cancel:{onCancel:function(){t.get("internalapi/pollshown",{params:{selection:0}}),u.getSafe().pollShown=0},text:"Not now. Remind me."},no:{onNo:function(){t.get("internalapi/pollshown",{params:{selection:-1}}),u.getSafe().pollShown=-1},text:"Nah, feck off!"}})}e.typeAheadWait=300,e.selectedItem="",e.autocompleteLoading=!1,e.isAskById=e.category.supportsById,e.isById={value:!0},e.availableIndexers=[],e.autocompleteClass="autocompletePosterMovies",e.toggle=function(t){e.category=t,e.isAskById=e.category.supportsById,c("searchfield");var n=f.find("#searchfield").controller("ngModel");if(angular.isDefined(n.$viewValue)&&n.$setViewValue(n.$viewValue+" "),x.searching.enableCategorySizes){var r=t.min,o=t.max;_.isNumber(r)?e.minsize=r:e.minsize="",_.isNumber(o)?e.maxsize=o:e.maxsize=""}e.availableIndexers=w()},e.getAutocomplete=function(n){return e.autocompleteLoading=!0,e.isById.value?e.category.name.indexOf("movies")>-1?t.get("internalapi/autocomplete?type=movie",{params:{input:n}}).then(function(t){return e.autocompleteLoading=!1,t.data.results}):e.category.name.indexOf("tv")>-1?t.get("internalapi/autocomplete?type=tv",{params:{input:n}}).then(function(t){return e.autocompleteLoading=!1,t.data.results}):{}:{}},e.startSearch=function(){h.start("Searching...");var t=angular.isUndefined(e.indexers)?void 0:e.indexers.join("|");l.search(e.category.name,e.query,e.tmdbid,e.imdbid,e.title,e.tvdbid,e.rid,e.season,e.episode,e.minsize,e.maxsize,e.minage,e.maxage,t,e.mode).then(function(){r.go("root.search.results",{minsize:e.minsize,maxsize:e.maxsize,minage:e.minage,maxage:e.maxage},{inherit:!0}),e.tmdbid=void 0,e.imdbid=void 0,e.tvdbid=void 0})},e.goToSearchUrl=function(){var t={};e.category.name.indexOf("movies")>-1?(t.title=e.title,t.mode="movie"):e.category.name.indexOf("tv")>-1?(t.mode="tvsearch",t.title=e.title):"ebook"==e.category.name?t.mode="ebook":t.mode="search",t.tmdbid=e.tmdbid,t.tvdbid=e.tvdbid,t.title=e.title,t.season=e.season,t.episode=e.episode,t.query=e.query,t.minsize=e.minsize,t.maxsize=e.maxsize,t.minage=e.minage,t.maxage=e.maxage,t.category=e.category.name,t.indexers=encodeURIComponent(b()),r.go("root.search",t,{inherit:!1,notify:!0,reload:!0})},e.repeatSearch=function(e){r.go("root.search",g.getStateParamsForRepeatedSearch(e),{inherit:!1,notify:!0,reload:!0})},e.selectAutocompleteItem=function(t){e.selectedItem=t,e.title=t.title,e.category.name.indexOf("movies")>-1?e.tmdbid=t.value:e.category.name.indexOf("tv")>-1&&(e.tvdbid=t.value),e.query="",e.goToSearchUrl()},e.startQuerySearch=function(){e.query?(e.title=void 0,e.tmdbid=void 0,e.tvdbid=void 0,e.season=void 0,e.episode=void 0,e.goToSearchUrl()):s.error("You didn't enter a query...")},e.autocompleteActive=function(){return e.category.supportsById},e.seriesSelected=function(){return e.category.name.indexOf("tv")>-1},e.toggleIndexer=function(t){e.indexers[t]=!e.indexers[t]},e.toggleAllIndexers=function(){angular.forEach(e.availableIndexers,function(e){e.activated=!e.activated})},e.searchInputChanged=function(){e.$broadcast("searchInputChanged",e.query!=n.query?e.query:null,e.minage,e.maxage,e.minsize,e.maxsize)},e.formatRequest=function(e){return i.trustAsHtml(g.formatRequest(e,!1,!0,!0,!0))},e.availableIndexers=w(),e.mode?e.startSearch():S(),e.$on("searchResultsShown",function(){S()})}function RestartService(e,t,n,r,o){function a(r,o){o>=1?(e.start(r+"Restarting. Will reload page in "+o+" seconds..."),t(function(){a(r,o-1)},1e3)):t(function(){e.start("Reloading page..."),n.location.reload()},1e3)}function i(){a("",15)}function s(e){e=angular.isDefined(e)?e+" ":"",o.restart().then(a(e,15),function(){r.info("Unable to send restart command.")})}return{restart:s,countdown:i}}function NzbHydraControlService(e){function t(){return e.get("internalapi/restart")}function n(){return e.get("internalapi/shutdown")}function r(){return e.get("internalapi/deleteloganddb")}return{restart:t,shutdown:n,deleteLogAndDb:r}}function NzbDownloadService(e,t,n){function r(t,n,r){var o={downloader:t.name,searchresultids:angular.toJson(n)};return"No category"!=r&&(o.category=r),e.put("internalapi/addnzbs",o)}function o(e,t){var o=e.defaultCategory;return!_.isUndefined(o)&&""!=o&&null!=o||"No category"==o?r(e,t,o):n.openCategorySelection(e).then(function(n){return r(e,t,n)},function(e){throw e})}function a(){return _.filter(t.getSafe().downloaders,"enabled")}var i={download:o,getEnabledDownloaders:a};return i}function ModalService(e,t){function n(t,n,r,o){var a=e.open({templateUrl:"static/html/modal.html",controller:"ModalInstanceCtrl",size:angular.isDefined(o)?o:"md",resolve:{headline:function(){return t},message:function(){return n},params:function(){return r}}});a.result.then(function(){},function(){})}return{open:n}}function ModalInstanceCtrl(e,t,n,r,o){e.message=r,e.headline=n,e.params=o,e.showCancel=angular.isDefined(o)&&angular.isDefined(o.cancel),e.showNo=angular.isDefined(o)&&angular.isDefined(o.no),angular.isUndefined(o)||angular.isUndefined(o.yes)?e.params={yes:{text:"Ok"}}:angular.isUndefined(o.yes.text)&&(o.yes.text="Yes"),angular.isDefined(o)&&angular.isDefined(o.no)&&angular.isUndefined(e.params.no.text)&&(e.params.no.text="No"),angular.isDefined(o)&&angular.isDefined(o.cancel)&&angular.isUndefined(e.params.cancel.text)&&(e.params.cancel.text="Cancel"),e.yes=function(){t.close(),angular.isDefined(o)&&angular.isDefined(o.yes)&&angular.isDefined(e.params.yes.onYes)&&e.params.yes.onYes()},e.no=function(){t.close(),angular.isDefined(o)&&angular.isDefined(o.no)&&angular.isDefined(e.params.no.onNo)&&e.params.no.onNo()},e.cancel=function(){t.dismiss(),angular.isDefined(o.cancel)&&angular.isDefined(e.params.cancel.onCancel)&&e.params.cancel.onCancel()},e.$on("modal.closing",function(t,n,r){"backdrop click"==n&&e.cancel()})}function GeneralModalService(){this.open=function(e,t,n,r,o){var a=angular.injector(["ng","ui.bootstrap"]),i=a.get("$uibModal"),s={};angular.isUndefined(r)&&(s.size=r),angular.isUndefined(t)?angular.isUndefined(n)?s.template="<pre>"+e+"</pre>":s.templateUrl=n:s.template=t,s.resolve={data:function(){return o}};var l=i.open(s);l.result.then()}}function LoginController(e,t,n,r,o){e.user={},e.login=function(){t.specificallyHandled(function(){r.login(e.user.username,e.user.password).then(function(){r.setLoggedInByForm(),o.info("Login successful!"),n.go("root.search")},function(){o.error("Login failed!")})})}}function IndexerStatusesController(e,t,n){e.statuses=n.data.indexerStatuses,e.isInPast=function(e){return 1e3*e<(new Date).getTime()},e.enable=function(n){t.get("internalapi/enableindexer",{params:{name:n}}).then(function(t){e.statuses=t.data.indexerStatuses})}}function formatDate(e){return function(t,n){if(t){if(1e3*t<(new Date).getTime()&&n)return"";var r=1e3*t;return r=e(r,"yyyy-MM-dd HH:mm")}return""}}function reformatDate(){return function(e){return moment.utc(e,"ddd, D MMM YYYY HH:mm:ss z").local().format("YYYY-MM-DD HH:mm")}}function IndexController(e,t,n,r){console.log("Index"),r.go("root.search")}function HydraAuthService(e,t,n,r){function o(){return r}function a(){return r.username}function i(){t.$broadcast("user:loggedIn")}function s(e,t,n){}function l(o,a){var i=e.defer();return n.post("auth/login",data={username:o,password:a}).then(function(e){r=e.data,h=!0,t.$broadcast("user:loggedIn"),i.resolve()})}function c(e){return n.get("internalapi/askforpassword",{params:e}).then(function(e){return r=e.data})}function u(){var o=e.defer();return n.post("auth/logout").then(function(e){t.$broadcast("user:loggedOut"),r=e.data,h=!1,o.resolve()})}function d(){var e=o();return{maySeeStats:e.maySeeStats,maySeeAdmin:e.maySeeAdmin,maySeeSearch:e.maySeeSearch}}function p(){return r.username}var h=r.username;return{isLoggedIn:a,login:l,askForPassword:c,logout:u,setLoggedInByForm:i,getUserRights:d,setLoggedInByBasic:s,getUserName:p,getUserInfos:o}}function HeaderController(e,t,n,r,o){function a(){e.userInfos=r.getUserInfos(),e.userInfos.authConfigured?e.userInfos.username?(e.showAdmin=e.userInfos.maySeeAdmin||!e.userInfos.adminRestricted,e.showStats=e.userInfos.maySeeStats||!e.userInfos.statsRestricted,e.showLoginout=!0,e.username=e.userInfos.username,e.loginlogoutText="Logout "+e.username,e.oldUserName=e.username):(e.showAdmin=!e.userInfos.adminRestricted,e.showStats=!e.userInfos.statsRestricted,e.loginlogoutText="Login",e.showLoginout=e.userInfos.adminRestricted||e.userInfos.statsRestricted||e.userInfos.searchRestricted,e.username=""):(e.showAdmin=!0,e.showStats=!0,e.showLoginout=!1)}e.showLoginout=!1,e.oldUserName=null,a(),e.$on("user:loggedIn",function(e,t){a()}),e.$on("user:loggedOut",function(e,t){a()});var i=document.getElementsByTagName("base"),s=null;i.length>0&&(s=i[0].href),e.loginout=function(){if(r.isLoggedIn())r.logout().then(function(){"basic"===e.userInfos.authType?n.info("Logged out. Close your browser to make sure session is closed."):"form"===e.userInfos.authType&&(n.info("Logged out"),window.location.href=s),a()});else if("basic"===e.userInfos.authType){var o={};e.oldUserName&&(o={old_username:e.oldUserName}),r.askForPassword(o).then(function(){n.info("Login successful!"),a(),e.oldUserName=null,t.go("root.search")})}else"form"===e.userInfos.authType?window.location.href=s+"login":n.info("You shouldn't need to login but here you go!")}}function ConfigBoxService(e,t){function n(n,r){var o=t.defer();return e.post(n,r).success(function(e){e.result?o.resolve():o.reject({checked:!0,message:e.message})}).error(function(e){o.reject({checked:!1,message:e.message})}),o.promise}function r(n,r,o){var a=t.defer();return e.post(n,r).success(function(e){e.success?(o.search_ids=e.supportedIds,o.searchTypes=e.supportedTypes,e.supportsAllCategories?o.categories=[]:o.categories=e.supportedCategories,o.animeCategory=e.animeCategory,o.audiobookCategory=e.audiobookCategory,o.comicCategory=e.comicCategory,o.ebookCategory=e.ebookCategory,o.magazineCategory=e.magazineCategory,o.backend=e.backend,a.resolve({supportedIds:e.supportedIds,supportedTypes:e.supportedTypes},o)):a.reject(e.message)}).error(function(){a.reject("Unknown error")}),a.promise}return{checkConnection:n,checkCaps:r}}function FileDownloadService(e,t){function n(n,r){e({method:"GET",url:n,responseType:"arraybuffer"}).success(function(e,t,n,o){var a=document.createElement("a"),i=new Blob([e],{type:"application/octet-stream"});a.href=URL.createObjectURL(i),a.download=r,document.body.appendChild(a),a.click(),document.body.removeChild(a)}).error(function(e,n,r,o){t.error(n)})}var r={downloadFile:n};return r}function DownloaderCategoriesService(e,t,n){function r(n){function r(){if(angular.isDefined(l)&&angular.isDefined(l.downloader)){var r=t.defer();return r.resolve(l.downloader),r.promise}return e.get("internalapi/getcategories",{params:{downloader:n.name}}).then(function(e){console.log("Updating downloader categories cache");({downloader:e.data.categories});return e.data.categories},function(e){throw e})}return r().then(function(e){return e},function(e){throw e})}function o(e){return n.open({templateUrl:"static/html/directives/addable-nzb-modal.html",controller:"DownloaderCategorySelectionController",size:"sm",resolve:{categories:function(){return r(e)}}}),s=t.defer(),s.promise}function a(e){c=e,console.log("Selected category "+e),s.resolve(e)}function i(){console.log("Invalidating categories"),l=void 0}var s,l={},c={},u={get:r,invalidate:i,select:a,openCategorySelection:o};return u}function DownloadHistoryController(e,t,n,r){e.limit=100,e.pagination={current:1},e.sortModel={column:"time",sortMode:2},e.filterModel={},e.indexersForFiltering=[],_.forEach(r.getSafe().indexers,function(t){e.indexersForFiltering.push({label:t.name,id:t.name})}),e.preselectedTimeInterval={beforeDate:null,afterDate:null},e.successfulForFiltering=[{label:"Succesful",id:!0},{label:"Unsuccesful",id:!1},{label:"Unknown",id:null}],e.accessOptionsForFiltering=[{label:"All",value:"all"},{label:"API",value:!1},{label:"Internal",value:!0}],e.nzbDownloads=n.data.nzbDownloads,e.totalDownloads=n.data.totalDownloads,e.update=function(){t.getDownloadHistory(e.pagination.current,e.limit,e.filterModel,e.sortModel).then(function(t){e.nzbDownloads=t.data.nzbDownloads,e.totalDownloads=t.data.totalDownloads})},e.$on("sort",function(t,n,r){0==r&&(n="time",r=2),e.sortModel={column:n,sortMode:r},e.$broadcast("newSortColumn",n),e.update()}),e.$on("filter",function(t,n,r,o){r.filter?e.filterModel[n]=r:delete e.filterModel[n],e.update()})}function reformatDateEpoch(){return function(e){return moment.unix(e).local().format("YYYY-MM-DD HH:mm")}}function ConfigService(e,t,n,r){function o(t){e.put("internalapi/setsettings",t).then(function(e){console.log("Settings saved. Updating cache"),c.put("config",t),s()},function(e){console.log("Error saving settings:"),console.log(e)})}function a(){var t=c.get("config");return angular.isUndefined(t)&&(t=e.get("internalapi/getconfig").then(function(e){return e.data}),c.put("config",t)),t}function i(){return u}function s(){e.get("internalapi/getsafeconfig").then(function(e){u=e.data})}function l(){function n(){var n=c.get("maySeeAdminArea");if(!angular.isUndefined(n)){var r=t.defer();return r.resolve(n),r.promise}return e.get("internalapi/mayseeadminarea").then(function(e){var t=e.data;return c.put("maySeeAdminArea",t),e.data})}return n().then(function(e){return e})}var c=n("nzbhydra"),u=r.safeConfig;return{set:o,get:a,getSafe:i,invalidateSafe:s,maySeeAdminArea:l}}function ConfigFields(e){function t(e){s=e}function n(e,t,n){t!=n&&s()}function r(){return{expression:function(e,t){var n=t||e;return n?/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/.test(n)||/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/.test(n):!0},message:'$viewValue + " is not a valid IP Address"'}}function o(e,t,n){return{expression:function(t,n){var r=n||t;return r?e.test(r):!0},message:(n?'$viewValue + " ':'" ')+t+'"'}}function a(){var t=[],n=e.get("ConfigService"),r=n.getSafe().categories;return t.push({key:"enableCategorySizes",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Category sizes",help:"Preset min and max sizes depending on the selected category"}}),_.each(r,function(e){if("all"!=e.name&&"na"!=e.name){var n=[{key:"categories."+e.name+".requiredWords",type:"horizontalInput",templateOptions:{type:"text",label:"Required words",placeholder:"separate, with, commas, like, this"}},{key:"categories."+e.name+".requiredRegex",type:"horizontalInput",templateOptions:{type:"text",label:"Required regex",help:"Must be present in a title (which is converted to lowercase before)"}},{key:"categories."+e.name+".forbiddenWords",type:"horizontalInput",templateOptions:{type:"text",label:"Forbidden words",placeholder:"separate, with, commas, like, this"}},{key:"categories."+e.name+".forbiddenRegex",type:"horizontalInput",templateOptions:{type:"text",label:"Forbidden regex",help:"Must not be present in a title (which is converted to lowercase before)"}},{key:"categories."+e.name+".applyRestrictions",type:"horizontalSelect",templateOptions:{label:"Apply restrictions",options:[{name:"Internal searches",value:"internal"},{name:"API searches",value:"external"},{name:"All searches",value:"both"}],help:"For which type of search word restrictions will be applied"}}];n.push({wrapper:"settingWrapper",templateOptions:{label:"Size preset"},fieldGroup:[{key:"categories."+e.name+".min",type:"duoSetting",templateOptions:{addonRight:{text:"MB"}}},{type:"duolabel"},{key:"categories."+e.name+".max",type:"duoSetting",templateOptions:{addonRight:{text:"MB"}}}]}),n.push({key:"categories."+e.name+".newznabCategories",type:"horizontalInput",templateOptions:{type:"text",label:"Newznab categories",help:"Map newznab categories to hydra categories",required:!0},parsers:[function(e){if(!e)return e;var t=[];return t.push.apply(t,e.split(",").map(Number)),t}]}),n.push({key:"categories."+e.name+".ignoreResults",type:"horizontalSelect",templateOptions:{label:"Ignore results",options:[{name:"For internal searches",value:"internal"},{name:"For API searches",value:"external"},{name:"Always",value:"always"},{name:"Never",value:"never"}],help:"Ignore results from this category"}}),t.push({wrapper:"fieldset",templateOptions:{label:e.pretty},fieldGroup:n})}}),t}function i(t){return{main:[{wrapper:"fieldset",templateOptions:{label:"Hosting"},fieldGroup:[{key:"host",type:"horizontalInput",templateOptions:{type:"text",label:"Host",required:!0,placeholder:"IPv4/6 address to bind to",help:"I strongly recommend using a reverse proxy instead of exposing this directly. Requires restart."},validators:{ipAddress:r()},watcher:{listener:n}},{key:"port",type:"horizontalInput",templateOptions:{type:"number",label:"Port",required:!0,placeholder:"5050",help:"Requires restart"},validators:{port:o(/^\d{1,5}$/,"is no valid port",!0)},watcher:{listener:n}},{key:"urlBase",type:"horizontalInput",templateOptions:{type:"text",label:"URL base",placeholder:"/nzbhydra",help:"Set when using an external proxy. Call using a trailing slash, e.g. http://www.domain.com/nzbhydra/"},validators:{urlBase:o(/^(\/\w+)*$/,"Base URL needs to start with a slash and must not end with one")}},{key:"externalUrl",type:"horizontalInput",templateOptions:{type:"text",label:"External URL",placeholder:"https://www.somedomain.com/nzbhydra/",help:"Set to the full external URL so machines outside can use the generated NZB links."}},{key:"useLocalUrlForApiAccess",type:"horizontalSwitch",hideExpression:"!model.externalUrl",templateOptions:{type:"switch",label:"Use local address in API results",help:"Disable to make API results use the external URL in NZB links."}},{key:"socksProxy",type:"horizontalInput",templateOptions:{type:"text",label:"SOCKS proxy",placeholder:"socks5://user:pass@127.0.0.1:1080",help:"IPv4 only"},watcher:{listener:n}},{key:"httpProxy",type:"horizontalInput",templateOptions:{type:"text",label:"HTTP proxy",placeholder:"http://user:pass@10.0.0.1:1080",help:"IPv4 only"},watcher:{listener:n}},{key:"httpsProxy",type:"horizontalInput",templateOptions:{type:"text",label:"HTTPS proxy",placeholder:"https://user:pass@10.0.0.1:1090",help:"IPv4 only"},watcher:{listener:n}},{key:"ssl",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Use SSL",help:"I recommend using a reverse proxy instead of this. Requires restart."},watcher:{listener:n}},{key:"sslcert",hideExpression:"!model.ssl",type:"horizontalInput",templateOptions:{type:"text",label:"SSL certificate file",required:!0,help:"Requires restart."},watcher:{listener:n}},{key:"sslkey",hideExpression:"!model.ssl",type:"horizontalInput",templateOptions:{type:"text",label:"SSL key file",required:!0,help:"Requires restart."},watcher:{listener:n}},{key:"sslca",hideExpression:"!model.ssl",type:"horizontalInput",templateOptions:{type:"text",label:"SSL intermediate certificate (CA file)",help:"Requires restart."},watcher:{listener:n}}]},{wrapper:"fieldset",templateOptions:{label:"UI"},fieldGroup:[{key:"theme",type:"horizontalSelect",templateOptions:{type:"select",label:"Theme",help:"Reload page after saving",options:[{name:"Grey",value:"grey"},{name:"Bright",value:"bright"},{name:"Dark",value:"dark"}]}}]},{wrapper:"fieldset",templateOptions:{label:"Security"},fieldGroup:[{key:"apikey",type:"horizontalApiKeyInput",templateOptions:{label:"API key",help:"Remove to disable. Alphanumeric only"},validators:{apikey:o(/^[a-zA-Z0-9]*$/,"API key must only contain numbers and digits",!1)}},{key:"dereferer",type:"horizontalInput",templateOptions:{type:"text",label:"Dereferer",help:"Redirect external links to hide your instance. Insert $s for target URL. Delete to disable."}},{key:"verifySsl",type:"horizontalSwitch",templateOptions:{label:"Verify SSL certificates",help:"If enabled only valid/known SSL certificates will be accepted when accessing indexers"}}]},{wrapper:"fieldset",key:"logging",templateOptions:{label:"Logging"},fieldGroup:[{key:"logfilelevel",type:"horizontalSelect",templateOptions:{type:"select",label:"Logfile level",options:[{name:"Critical",value:"CRITICAL"},{name:"Error",value:"ERROR"},{name:"Warning",value:"WARNING"},{name:"Info",value:"INFO"},{name:"Debug",value:"DEBUG"}]},watcher:{listener:n}},{key:"logfilename",type:"horizontalInput",templateOptions:{type:"text",label:"Log file",required:!0},watcher:{listener:n}},{key:"rolloverAtStart",type:"horizontalSwitch",templateOptions:{label:"Startup rollover",help:"Starts a new log file on start/restart"},watcher:{listener:n}},{key:"logMaxSize",type:"horizontalInput",templateOptions:{type:"number",label:"Max log file size",help:"When log file size is reached a new one is started. Set to 0 to disable.",addonRight:{text:"kB"}},watcher:{listener:n}},{key:"logRotateAfterDays",type:"horizontalInput",templateOptions:{type:"number",label:"Rotate after",help:"A new log file is started after this many days. Supercedes max size. Keep empty to disable.",addonRight:{text:"days"}},watcher:{listener:n}},{key:"keepLogFiles",type:"horizontalInput",templateOptions:{type:"number",label:"Keep log files",help:"Number of log files to keep before oldest is deleted."},watcher:{listener:n}},{key:"logfileUmask",type:"horizontalInput",templateOptions:{type:"text",label:"Log file chmod",help:"chmod for log files (linux only)"},watcher:{listener:n}},{key:"consolelevel",type:"horizontalSelect",templateOptions:{type:"select",label:"Console log level",options:[{name:"Critical",value:"CRITICAL"},{name:"Error",value:"ERROR"},{name:"Warning",value:"WARNING"},{name:"Info",value:"INFO"},{name:"Debug",value:"DEBUG"}]},watcher:{listener:n}},{key:"logIpAddresses",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Log IP addresses"}}]},{wrapper:"fieldset",templateOptions:{label:"Updating"},fieldGroup:[{key:"gitPath",type:"horizontalInput",templateOptions:{label:"Git executable",help:"Set if git is not in your path"}},{key:"branch",type:"horizontalInput",templateOptions:{type:"text",label:"Repository branch",required:!0,help:"Stay on master. Seriously..."}}]},{wrapper:"fieldset",templateOptions:{label:"Other"},fieldGroup:[{key:"keepSearchResultsForDays",type:"horizontalInput",templateOptions:{type:"number",label:"Store results for ...",addonRight:{text:"days"},required:!0,help:"Meta data from searches is stored in the database. When they're deleted links to hydra become invalid."}},{key:"debug",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Enable debugging",help:"Only do this if you know what and why you're doing it"}},{key:"runThreaded",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Run threaded server",help:"Requires restart"},watcher:{listener:n}},{key:"startupBrowser",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Open browser on startup"}},{key:"shutdownForRestart",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Shutdown to restart",help:"When run with a service manager which automatically restarts Hydra enable this to prevent duplicate instances"}}]}],searching:[{wrapper:"fieldset",templateOptions:{label:"Indexer access"},fieldGroup:[{key:"timeout",type:"horizontalInput",templateOptions:{type:"number",label:"Timeout when accessing indexers",addonRight:{text:"seconds"}}},{key:"ignoreTemporarilyDisabled",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Ignore temporarily disabled",help:"If enabled access to indexers will never be paused after an error occurred"}},{key:"ignorePassworded",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Ignore passworded releases",help:"Not all indexers provide this information"}},{key:"forbiddenWords",type:"horizontalInput",templateOptions:{type:"text",label:"Forbidden words",placeholder:"separate, with, commas, like, this",help:"Results with any of these words in the title will be ignored"}},{key:"forbiddenRegex",type:"horizontalInput",templateOptions:{type:"text",label:"Forbidden regex",help:"Must not be present in a title (which is converted to lowercase before)"}},{key:"requiredWords",type:"horizontalInput",templateOptions:{type:"text",label:"Required words",placeholder:"separate, with, commas, like, this",help:"Only results with at least one of these words in the title will be used"}},{key:"requiredRegex",type:"horizontalInput",templateOptions:{type:"text",label:"Required regex",help:"Must be present in a title (which is converted to lowercase before)"}},{key:"applyRestrictions",type:"horizontalSelect",templateOptions:{label:"Apply word restrictions",options:[{name:"Internal searches",value:"internal"},{name:"API searches",value:"external"},{name:"All searches",value:"both"}],help:"For which type of search word restrictions will be applied"}},{key:"forbiddenGroups",type:"horizontalInput",templateOptions:{type:"text",label:"Forbidden groups",placeholder:"separate, with, commas, like, this",help:"Posts from any groups containing any of these words will be ignored"}},{key:"forbiddenPosters",type:"horizontalInput",templateOptions:{type:"text",label:"Forbidden posters",placeholder:"separate, with, commas, like, this",help:"Posts from any posters containing any of these words will be ignored"}},{key:"maxAge",type:"horizontalInput",templateOptions:{type:"number",label:"Maximum results age",help:"Results older than this are ignored. Can be overwritten per search",addonRight:{text:"days"}}},{key:"generate_queries",type:"horizontalMultiselect",templateOptions:{label:"Generate queries",options:[{label:"Internal searches",id:"internal"},{label:"API searches",id:"external"}],help:"Generate queries for indexers which do not support ID based searches"}},{key:"idFallbackToTitle",type:"horizontalMultiselect",templateOptions:{label:"Fallback to title queries",options:[{label:"Internal searches",id:"internal"},{label:"API searches",id:"external"}],help:"When no results were found for a query ID search again using the title"}},{key:"idFallbackToTitlePerIndexer",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Fallback per indexer",help:"If enabled, fallback will occur on a per-indexer basis"}},{key:"userAgent",type:"horizontalInput",templateOptions:{type:"text",label:"User agent",required:!0}}]},{wrapper:"fieldset",templateOptions:{label:"Result processing"},fieldGroup:[{key:"htmlParser",type:"horizontalSelect",templateOptions:{type:"select",label:"HTML parser",options:[{name:"Default BS (slower)",
value:"html.parser"},{name:"LXML (faster, needs to be installed separately)",value:"lxml"}]}},{key:"duplicateSizeThresholdInPercent",type:"horizontalPercentInput",templateOptions:{type:"text",label:"Duplicate size threshold",required:!0,addonRight:{text:"%"}}},{key:"duplicateAgeThreshold",type:"horizontalInput",templateOptions:{type:"number",label:"Duplicate age threshold",required:!0,addonRight:{text:"hours"}}},{key:"alwaysShowDuplicates",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Always show duplicates",help:"Activate to show duplicates in search results by default"}},{key:"removeTrailing",type:"horizontalInput",templateOptions:{type:"text",label:"Remove trailing...",help:"Removed from title if it ends with either of these. Case insensitive and disregards leading/trailing spaces"}},{key:"nzbAccessType",type:"horizontalSelect",templateOptions:{type:"select",label:"NZB access type",options:[{name:"Proxy NZBs from indexer",value:"serve"},{name:"Redirect to the indexer",value:"redirect"}],help:"How access to NZBs is provided when NZBs are downloaded (by the user or external tools). Redirecting is recommended."}}]}],categories:a(),downloaders:[{type:"arrayConfig",data:{defaultModel:{enabled:!0},entryTemplateUrl:"downloaderEntry.html",presets:function(){return getDownloaderPresets()},checkAddingAllowed:function(){return!0},presetsOnly:!0,addNewText:"Add new downloader",fieldsFunction:getDownloaderBoxFields,allowDeleteFunction:function(){return!0},checkBeforeClose:function(t,n){var r=e.get("DownloaderCheckBeforeCloseService");return r.check(t,n)},resetFunction:function(e){e.options.resetModel(),e.options.resetModel()}}}],indexers:[{type:"arrayConfig",data:{defaultModel:{animeCategory:null,comicCategory:null,audiobookCategory:null,magazineCategory:null,ebookCategory:null,enabled:!0,categories:[],downloadLimit:null,loadLimitOnRandom:null,host:null,apikey:null,hitLimit:null,hitLimitResetTime:0,timeout:null,name:null,showOnSearch:!0,score:0,username:null,password:null,preselect:!0,type:"newznab",accessType:"both",search_ids:void 0,searchTypes:void 0,backend:null,userAgent:null},addNewText:"Add new indexer",entryTemplateUrl:"indexerEntry.html",presets:function(e){return getIndexerPresets(e)},checkAddingAllowed:function(e,t){return!t||"anizb"!=t.type&&"binsearch"!=t.type&&"nzbindex"!=t.type&&"nzbclub"!=t.type?!0:!_.any(e,function(e){return e.name==t.name})},fieldsFunction:getIndexerBoxFields,allowDeleteFunction:function(e){return!0},checkBeforeClose:function(t,n){var r=e.get("IndexerCheckBeforeCloseService");return r.check(t,n)},resetFunction:function(e){e.options.resetModel(),e.options.resetModel()}}}],auth:[{key:"authType",type:"horizontalSelect",templateOptions:{label:"Auth type",options:[{name:"None",value:"none"},{name:"HTTP Basic auth",value:"basic"},{name:"Login form",value:"form"}]}},{key:"restrictSearch",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Restrict searching",help:"Restrict access to searching"},hideExpression:function(){return"none"==t.auth.authType}},{key:"restrictStats",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Restrict stats",help:"Restrict access to stats"},hideExpression:function(){return"none"==t.auth.authType}},{key:"restrictAdmin",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Restrict admin",help:"Restrict access to admin functions"},hideExpression:function(){return"none"==t.auth.authType}},{key:"restrictDetailsDl",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Restrict NZB details & DL",help:"Restrict NZB details, comments and download links"},hideExpression:function(){return"none"==t.auth.authType}},{key:"restrictIndexerSelection",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Restrict indexer selection box",help:"Restrict visibility of indexer selection box in search. Affects only GUI"},hideExpression:function(){return"none"==t.auth.authType}},{key:"rememberUsers",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Remember users",help:"Remember users with cookie for 14 days"},hideExpression:function(){return"none"==t.auth.authType}},{key:"rememberUsersExpiry",type:"horizontalInput",templateOptions:{type:"number",label:"Cookie expiry",help:"How long users are remembered",addonRight:{text:"days"}}},{type:"repeatSection",key:"users",model:t.auth,templateOptions:{btnText:"Add new user",altLegendText:"Authless",fields:[{key:"username",type:"horizontalInput",templateOptions:{type:"text",label:"Username",required:!0}},{key:"password",type:"horizontalInput",templateOptions:{type:"password",label:"Password",required:!0}},{key:"maySeeAdmin",type:"horizontalSwitch",templateOptions:{type:"switch",label:"May see admin area"}},{key:"maySeeStats",type:"horizontalSwitch",templateOptions:{type:"switch",label:"May see stats"},hideExpression:"model.maySeeAdmin"},{key:"maySeeDetailsDl",type:"horizontalSwitch",templateOptions:{type:"switch",label:"May see NZB details & DL links"},hideExpression:"model.maySeeAdmin"},{key:"showIndexerSelection",type:"horizontalSwitch",templateOptions:{type:"switch",label:"May see indexer selection box"},hideExpression:"model.maySeeAdmin"}],defaultModel:{username:null,password:null,maySeeStats:!0,maySeeAdmin:!0,maySeeDetailsDl:!0,showIndexerSelection:!0}}}]}}var s;return{getFields:i,setRestartWatcher:t}}function getIndexerPresets(e){var t=[[{name:"6box",host:"https://6box.me"},{name:"6box spotweb",host:"https://6box.me/spotweb"},{name:"altHUB",host:"https://api.althub.co.za"},{name:"DogNZB",host:"https://api.dognzb.cr"},{name:"Drunken Slug",host:"https://api.drunkenslug.com"},{name:"LuluNZB",host:"https://lulunzb.com"},{name:"miatrix",host:"https://www.miatrix.com"},{name:"newz69.keagaming",host:"https://newz69.keagaming.com"},{name:"NewzTown",host:"https://newztown.co.za"},{name:"NZB Finder",host:"https://nzbfinder.ws"},{name:"NZBCat",host:"https://nzb.cat"},{name:"nzb.ag",host:"https://nzb.ag"},{name:"nzb.is",host:"https://nzb.is"},{name:"nzb.su",host:"https://api.nzb.su"},{name:"nzb7",host:"https://www.nzb7.com"},{name:"NZBGeek",host:"https://api.nzbgeek.info"},{name:"NzbNdx",host:"https://www.nzbndx.com"},{name:"NzBNooB",host:"https://www.nzbnoob.com"},{name:"nzbplanet",host:"https://nzbplanet.net"},{name:"NZBs.org",host:"https://nzbs.org"},{name:"NZBs.io",host:"https://www.nzbs.io"},{name:"Nzeeb",host:"https://www.nzeeb.com"},{name:"oznzb",host:"https://api.oznzb.com"},{name:"omgwtfnzbs",host:"https://api.omgwtfnzbs.me"},{name:"PFMonkey",host:"https://www.pfmonkey.com"},{name:"SimplyNZBs",host:"https://simplynzbs.com"},{name:"Tabula-Rasa",host:"https://www.tabula-rasa.pw"},{name:"Usenet-Crawler",host:"https://www.usenet-crawler.com"}],[{name:"Jackett/Cardigann",host:"http://127.0.0.1:9117/torznab/YOURTRACKER",search_ids:[],searchTypes:[],type:"jackett",accessType:"internal"}],[{accessType:"both",categories:["anime"],downloadLimit:null,enabled:!1,hitLimit:null,hitLimitResetTime:null,host:"https://anizb.org",loadLimitOnRandom:null,name:"anizb",password:null,preselect:!0,score:0,search_ids:[],searchTypes:[],showOnSearch:!0,timeout:null,type:"anizb",username:null},{accessType:"internal",categories:[],downloadLimit:null,enabled:!0,hitLimit:null,hitLimitResetTime:null,host:"https://binsearch.info",loadLimitOnRandom:null,name:"Binsearch",password:null,preselect:!0,score:0,search_ids:[],searchTypes:[],showOnSearch:!0,timeout:null,type:"binsearch",username:null},{accessType:"internal",categories:[],downloadLimit:null,enabled:!0,hitLimit:null,hitLimitResetTime:null,host:"https://www.nzbclub.com",loadLimitOnRandom:null,name:"NZBClub",password:null,preselect:!0,score:0,search_ids:[],searchTypes:[],showOnSearch:!0,timeout:null,type:"nzbclub",username:null},{accessType:"internal",categories:[],downloadLimit:null,enabled:!0,generalMinSize:1,hitLimit:null,hitLimitResetTime:null,host:"https://nzbindex.com",loadLimitOnRandom:null,name:"NZBIndex",password:null,preselect:!0,score:0,search_ids:[],searchTypes:[],showOnSearch:!0,timeout:null,type:"nzbindex",username:null}]];return t}function getIndexerBoxFields(e,t,n,r){var o=[];return o.push({key:"enabled",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Enabled"}}),("newznab"==e.type||"jackett"==e.type)&&o.push({key:"name",type:"horizontalInput",templateOptions:{type:"text",label:"Name",required:!0,help:"Used for identification. Changing the name will lose all history and stats!"},validators:{uniqueName:{expression:function(r){return n||r!=e.name?-1==_.pluck(t,"name").indexOf(r):!0},message:'"Indexer \\"" + $viewValue + "\\" already exists"'}}}),("newznab"==e.type||"jackett"==e.type)&&o.push({key:"host",type:"horizontalInput",templateOptions:{type:"text",label:"Host",required:!0,placeholder:"http://www.someindexer.com"},watcher:{listener:function(e,t,n,r){t!=n&&(r.$parent.needsConnectionTest=!0)}}}),("newznab"==e.type||"jackett"==e.type)&&o.push({key:"apikey",type:"horizontalInput",templateOptions:{type:"text",label:"API Key"},watcher:{listener:function(e,t,n,r){t!=n&&(r.$parent.needsConnectionTest=!0)}}}),o.push({key:"score",type:"horizontalInput",templateOptions:{type:"number",label:"Priority",required:!0,help:"When duplicate search results are found the result from the indexer with the highest number will be selected"}}),o.push({key:"timeout",type:"horizontalInput",templateOptions:{type:"number",label:"Timeout",help:'Supercedes the general timeout in "Searching"'}}),("newznab"==e.type||"jackett"==e.type)&&(o.push({key:"hitLimit",type:"horizontalInput",templateOptions:{type:"number",label:"API hit limit",help:'Maximum number of API hits since "API hit reset time"'}},{key:"downloadLimit",type:"horizontalInput",templateOptions:{type:"number",label:"Download limit",help:'When # of downloads since "Hit reset time" is reached indexer will not be searched.'}}),o.push({key:"loadLimitOnRandom",type:"horizontalInput",templateOptions:{type:"number",label:"Load limiting",help:"If set indexer will only be picked for one out of x API searches (on average)"},validators:{greaterThanZero:{expression:function(e,t){var n=t||e;return angular.isUndefined(n)||null===n||""===n||n>1},message:'"Value must be greater than 1"'}}},{key:"hitLimitResetTime",type:"horizontalInput",hideExpression:"!model.hitLimit && !model.downloadLimit",templateOptions:{type:"number",label:"Hit reset time",help:"UTC hour of day at which the API hit counter is reset (0==24). Leave empty for a rolling reset counter"},validators:{timeOfDay:{expression:function(e,t){var n=t||e;return n>=0&&24>=n},message:'$viewValue + " is not a valid hour of day (0-24)"'}}})),"newznab"==e.type&&o.push({key:"username",type:"horizontalInput",templateOptions:{type:"text",required:!1,label:"Username",help:"Only needed if indexer requires HTTP auth for API access (rare)"},watcher:{listener:function(e,t,n,r){t!=n&&(r.$parent.needsConnectionTest=!0)}}}),"newznab"==e.type&&o.push({key:"password",type:"horizontalInput",hideExpression:"!model.username",templateOptions:{type:"text",required:!1,label:"Password",help:"Only needed if indexer requires HTTP auth for API access (rare)"}}),"newznab"==e.type&&o.push({key:"userAgent",type:"horizontalInput",templateOptions:{type:"text",required:!1,label:"User agent",help:"Rarely needed. Will supercede the one in the main searching settings"}}),o.push({key:"preselect",type:"horizontalSwitch",hideExpression:'model.accessType == "external"',templateOptions:{type:"switch",label:"Preselect",help:"Preselect this indexer on the search page"}}),"jackett"!=e.type&&o.push({key:"accessType",type:"horizontalSelect",templateOptions:{label:"Enable for...",options:[{name:"Internal searches only",value:"internal"},{name:"API searches only",value:"external"},{name:"Internal and API searches",value:"both"}]}}),"anizb"!=e.type&&o.push({key:"categories",type:"horizontalMultiselect",templateOptions:{label:"Enable for...",help:"You can decide that this indexer should only be used for certain categories",options:[{id:"movies",label:"Movies"},{id:"movieshd",label:"Movies HD"},{id:"moviessd",label:"Movies SD"},{id:"tv",label:"TV"},{id:"tvhd",label:"TV HD"},{id:"tvsd",label:"TV SD"},{id:"anime",label:"Anime"},{id:"audio",label:"Audio"},{id:"flac",label:"Audio FLAC"},{id:"mp3",label:"Audio MP3"},{id:"audiobook",label:"Audiobook"},{id:"console",label:"Console"},{id:"pc",label:"PC"},{id:"xxx",label:"XXX"},{id:"ebook",label:"Ebook"},{id:"comic",label:"Comic"}],getPlaceholder:function(){return"All categories"}}}),"newznab"==e.type&&o.push({key:"search_ids",type:"horizontalMultiselect",templateOptions:{label:"Search IDs",options:[{label:"TVDB",id:"tvdbid"},{label:"TVRage",id:"rid"},{label:"IMDB",id:"imdbid"},{label:"Trakt",id:"traktid"},{label:"TVMaze",id:"tvmazeid"},{label:"TMDB",id:"tmdbid"}],getPlaceholder:function(e){return angular.isUndefined(e)?"Unknown":"None"}}}),("newznab"==e.type||"jackett"==e.type)&&o.push({key:"searchTypes",type:"horizontalMultiselect",templateOptions:{label:"Search types",options:[{label:"Movies",id:"movie"},{label:"TV",id:"tvsearch"},{label:"Ebooks",id:"book"},{label:"Audio",id:"audio"}],getPlaceholder:function(e){return angular.isUndefined(e)?"Unknown":"None"}}}),("newznab"==e.type||"jackett"==e.type)&&o.push({type:"horizontalCheckCaps",hideExpression:"!model.host || !model.apikey || !model.name",templateOptions:{label:"Check capabilities",help:"Find out what search types the indexer supports. Done automatically for new indexers."}}),"nzbindex"==e.type&&o.push({key:"generalMinSize",type:"horizontalInput",templateOptions:{type:"number",label:"Min size",help:"NZBIndex returns a lot of crap with small file sizes. Set this value and all smaller results will be filtered out no matter the category"}}),o}function getDownloaderBoxFields(e,t,n){var r=[];return r=_.union(r,[{key:"enabled",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Enabled"}},{key:"name",type:"horizontalInput",templateOptions:{type:"text",label:"Name",required:!0},validators:{uniqueName:{expression:function(r){return n||r!=e.name?-1==_.pluck(t,"name").indexOf(r):!0},message:'"Downloader \\"" + $viewValue + "\\" already exists"'}}}]),"nzbget"==e.type?r=_.union(r,[{key:"host",type:"horizontalInput",templateOptions:{type:"text",label:"Host",required:!0},watcher:{listener:function(e,t,n,r){t!=n&&(r.$parent.needsConnectionTest=!0)}}},{key:"port",type:"horizontalInput",templateOptions:{type:"number",label:"Port",placeholder:"5050",required:!0},watcher:{listener:function(e,t,n,r){t!=n&&(r.$parent.needsConnectionTest=!0)}}},{key:"ssl",type:"horizontalSwitch",templateOptions:{type:"switch",label:"Use SSL"}}]):"sabnzbd"==e.type&&r.push({key:"url",type:"horizontalInput",templateOptions:{type:"text",label:"URL",required:!0},watcher:{listener:function(e,t,n,r){t!=n&&(r.$parent.needsConnectionTest=!0)}}}),r=_.union(r,[{key:"username",type:"horizontalInput",templateOptions:{type:"text",label:"Username",help:"nzbget"==e.type?"Only alphanumeric usernames are guaranteed to work":""},watcher:{listener:function(e,t,n,r){t!=n&&(r.$parent.needsConnectionTest=!0)}}},{key:"password",type:"horizontalInput",templateOptions:{type:"password",label:"Password",help:"nzbget"==e.type?"See username":""},watcher:{listener:function(e,t,n,r){t!=n&&(r.$parent.needsConnectionTest=!0)}}}]),"sabnzbd"==e.type&&r.push({key:"apikey",type:"horizontalInput",templateOptions:{type:"text",label:"API Key"},watcher:{listener:function(e,t,n,r){t!=n&&(r.$parent.needsConnectionTest=!0)}}}),r=_.union(r,[{key:"defaultCategory",type:"horizontalInput",templateOptions:{type:"text",label:"Default category",help:'When adding NZBs this category will be used instead of asking for the category. Write "No category" to let the downloader decide.',placeholder:"Ask when downloading"}},{key:"nzbaccesstype",type:"horizontalSelect",templateOptions:{type:"select",label:"NZB access type",options:[{name:"Proxy NZBs from indexer",value:"serve"},{name:"Redirect to the indexer",value:"redirect"}],help:"How external access to NZBs is provided. Redirecting is recommended."}},{key:"nzbAddingType",type:"horizontalSelect",templateOptions:{type:"select",label:"NZB adding type",options:[{name:"Send link",value:"link"},{name:"Upload NZB",value:"nzb"}],help:"How NZBs are added to the downloader, either by sending a link to the NZB or by uploading the NZB data"}},{key:"iconCssClass",type:"horizontalInput",templateOptions:{type:"text",label:"Icon CSS class",help:'Copy an icon name from http://fontawesome.io/examples/ (e.g. "film")',placeholder:"Default"}}])}function getDownloaderPresets(){return[[{host:"127.0.0.1",name:"NZBGet",password:"tegbzn6789x",port:6789,ssl:!1,type:"nzbget",username:"nzbgetx",nzbAddingType:"link",nzbaccesstype:"redirect",iconCssClass:"",downloadType:"nzb"},{url:"http://localhost:8086",type:"sabnzbd",name:"SABnzbd",nzbAddingType:"link",nzbaccesstype:"redirect",iconCssClass:"",downloadType:"nzb",username:null,password:null}]]}function handleConnectionCheckFail(e,t,n,r,o){var a,i;t.checked?(a="The connection to the "+r+" failed: "+t.message+"<br>Do you want to add it anyway?",i="I know what I'm doing"):(a="The connection to the "+r+" could not be tested, sorry",i="I'll risk it"),e.open("Connection check failed",a,{yes:{onYes:function(){o.resolve()},text:i},no:{onNo:function(){n.enabled=!1,o.resolve()},text:"Add it, but disabled"},cancel:{onCancel:function(){o.reject()},text:"Aahh, let me try again"}})}function IndexerCheckBeforeCloseService(e,t,n,r,o){function a(a,s){var l=e.defer();if(a.needsConnectionTest){r.start("Testing connection..."),a.spinnerActive=!0;var c="internalapi/test_newznab",u={host:s.host,apikey:s.apikey};angular.isDefined(s.username)&&(u.username=s.username,u.password=s.password),n.checkConnection(c,JSON.stringify(u)).then(function(){i(a,s).then(function(){r.reset(),a.spinnerActive=!1,o.info("Connection to the indexer tested successfully"),l.resolve()},function(){r.reset(),a.spinnerActive=!1,l.reject()})},function(e){r.reset(),handleConnectionCheckFail(t,e,s,"indexer",l)})["finally"](function(){a.spinnerActive=!1,r.reset()})}else i(a,s).then(function(){l.resolve()},function(){l.reject()});return l.promise}function i(a,i){var s=e.defer(),l="internalapi/test_caps",c={indexer:i.name,apikey:i.apikey,host:i.host};return angular.isDefined(i.username)&&(c.username=i.username,c.password=i.password),angular.isUndefined(i.search_ids)||angular.isUndefined(i.searchTypes)?(r.start("New indexer found. Testing its capabilities. This may take a bit..."),n.checkCaps(l,JSON.stringify(c),i).then(function(e,t){r.reset(),a.spinnerActive=!1,o.info("Successfully tested capabilites of indexer"),s.resolve()},function(){r.reset(),a.spinnerActive=!1,i.search_ids=[],i.searchTypes=[],t.open("Error testing capabilities","The capabilities of the indexer could not be checked. The indexer won't be used for ID based searches (IMDB, TVDB, etc.). You may repeat the check manually at any time."),s.resolve()})["finally"](function(){a.spinnerActive=!1})):s.resolve(),s.promise}return{check:a}}function DownloaderCheckBeforeCloseService(e,t,n,r,o){function a(a,i){var s=e.defer();if(a.isInitial||a.needsConnectionTest){a.spinnerActive=!0,o.start("Testing connection...");var l="internalapi/test_downloader";t.checkConnection(l,JSON.stringify(i)).then(function(){o.reset(),a.spinnerActive=!1,n.info("Connection to the downloader tested successfully"),s.resolve()},function(e){o.reset(),a.spinnerActive=!1,handleConnectionCheckFail(r,e,i,"downloader",s)})["finally"](function(){a.spinnerActive=!1,o.reset()})}else s.resolve();return s.promise}return{check:a}}function ConfigController(e,t,n,r,o,a,i,s,l,c,u,d){function p(){if(e.form.$valid)r.set(e.config),e.form.$setPristine(),a.invalidate(),e.restartRequired&&l.open("Restart required","The changes you have made may require a restart to be effective.<br>Do you want to restart now?",{yes:{onYes:function(){c.restart()}},no:{onNo:function(){e.restartRequired=!1}}});else{d.error("Config invalid. Please check your settings.");try{angular.isDefined(form.$error.required)&&_.each(form.$error.required,function(e){angular.isDefined(e.$error.required)&&_.each(e.$error.required,function(e){e.$setTouched()})}),angular.forEach(e.form.$error.required,function(e){e.$setTouched()})}catch(t){}}}e.config=o,e.submit=p,e.activeTab=n,e.restartRequired=!1,e.ignoreSaveNeeded=!1,i.setRestartWatcher(function(){e.restartRequired=!0}),s=o,e.fields=i.getFields(e.config),e.allTabs=[{active:!1,state:"root.config.main",name:"Main",model:s.main,fields:e.fields.main,options:{}},{active:!1,state:"root.config.auth",name:"Authorization",model:s.auth,fields:e.fields.auth,options:{}},{active:!1,state:"root.config.searching",name:"Searching",model:s.searching,fields:e.fields.searching,options:{}},{active:!1,state:"root.config.categories",name:"Categories",model:s.categories,fields:e.fields.categories,options:{}},{active:!1,state:"root.config.downloader",name:"Downloaders",model:s.downloaders,fields:e.fields.downloaders,options:{}},{active:!1,state:"root.config.indexers",name:"Indexers",model:s.indexers,fields:e.fields.indexers,options:{}}],e.isSavingNeeded=function(){return e.form.$dirty&&e.form.$valid&&!e.ignoreSaveNeeded},e.goToConfigState=function(t){u.go(e.allTabs[t].state,{activeTab:t},{inherit:!1,notify:!0,reload:!0})},e.help=function(){var n=e.allTabs[e.activeTab].name;t.get("internalapi/gethelp",{params:{id:n}}).then(function(e){var t='<span style="text-align: left;">'+e.data+"</span>";l.open(n+" - Help",t,{},"lg")},function(){d.error("Error while loading help")})},e.$on("$stateChangeStart",function(t,n,r,o,a){e.isSavingNeeded()&&(t.preventDefault(),l.open("Unsaved changed","Do you want to save before leaving?",{yes:{onYes:function(){e.submit(),u.go(n)},text:"Yes"},no:{onNo:function(){e.ignoreSaveNeeded=!0,e.allTabs[e.activeTab].options.resetModel(),u.go(n)},text:"No"},cancel:{onCancel:function(){t.preventDefault()},text:"Cancel"}}))})}function CategoriesService(e){function t(t){for(var n in e.getSafe().categories)if(n=e.getSafe().categories[n],n.name==t||n.pretty==t)return n}function n(){return e.getSafe().categories}function r(){return n()[1]}return{getByName:t,getAll:n,getDefault:r}}function BackupService(e){function t(){return e.get("internalapi/getbackups").then(function(e){return e.data.backups})}function n(t){return e.get("internalapi/restorefrombackupfile",{params:{filename:t}}).then(function(e){return e})}return{getBackupsList:t,restoreFromFile:n}}var nzbhydraapp=angular.module("nzbhydraApp",["angular-loading-bar","cgBusy","ui.bootstrap","ipCookie","angular-growl","angular.filter","filters","ui.router","blockUI","mgcrea.ngStrap","angularUtils.directives.dirPagination","nvd3","formly","formlyBootstrap","frapontillo.bootstrap-switch","ui.select","ngSanitize","checklist-model","ngAria","ngMessages","ui.router.title","LocalStorageModule","angular.filter","ngFileUpload","ngCookies"]);angular.module("nzbhydraApp").config(["$stateProvider","$urlRouterProvider","$locationProvider","blockUIConfig","$urlMatcherFactoryProvider","localStorageServiceProvider","bootstrapped",function(e,t,n,r,o,a,i){function s(e,t,n,r,o){var a=e.defer(),i=r.getUserInfos(),s=!1;return s="search"==o?!i.searchRestricted||i.maySeeSearch:"stats"==o?!i.statsRestricted||i.maySeeStats:"admin"==o?!i.adminRestricted||i.maySeeAdmin:!0,s||"form"!=i.authType?a.resolve():t(function(){n.go("root.login")}),a.promise}r.autoBlock=!1,o.strictMode(!1),t.otherwise("/"),e.state("root",{url:"","abstract":!0,resolve:{},views:{header:{templateUrl:"static/html/states/header.html",controller:"HeaderController"},footer:{templateUrl:"footer.html"}}}).state("root.config",{url:"/config",views:{},"abstract":!0}).state("root.config.main",{url:"/main",views:{"container@":{templateUrl:"static/html/states/config.html",controller:"ConfigController",controllerAs:"ctrl",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],config:["loginRequired","ConfigService",function(e,t){return t.get()}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 0}],$title:["$stateParams",function(e){return"Config (Main)"}]}}}}).state("root.config.auth",{url:"/auth",views:{"container@":{templateUrl:"static/html/states/config.html",controller:"ConfigController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],config:["loginRequired","ConfigService",function(e,t){return t.get()}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 1}],$title:["$stateParams",function(e){return"Config (Auth)"}]}}}}).state("root.config.searching",{url:"/searching",views:{"container@":{templateUrl:"static/html/states/config.html",controller:"ConfigController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],config:["loginRequired","ConfigService",function(e,t){return t.get()}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 2}],$title:["$stateParams",function(e){return"Config (Searching)"}]}}}}).state("root.config.categories",{url:"/categories",views:{"container@":{templateUrl:"static/html/states/config.html",controller:"ConfigController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],config:["loginRequired","ConfigService",function(e,t){return t.get()}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 3}],$title:["$stateParams",function(e){return"Config (Categories)"}]}}}}).state("root.config.downloader",{url:"/downloader",views:{"container@":{templateUrl:"static/html/states/config.html",controller:"ConfigController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],config:["loginRequired","ConfigService",function(e,t){return t.get()}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 4}],$title:["$stateParams",function(e){return"Config (Downloader)"}]}}}}).state("root.config.indexers",{url:"/indexers",views:{"container@":{templateUrl:"static/html/states/config.html",controller:"ConfigController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],config:["loginRequired","ConfigService",function(e,t){return t.get()}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 5}],$title:["$stateParams",function(e){return"Config (Indexers)"}]}}}}).state("root.stats",{url:"/stats","abstract":!0,views:{"container@":{templateUrl:"static/html/states/stats.html",controller:["$scope","$state",function(e,t){e.$state=t}],resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"stats")}],$title:["$stateParams",function(e){return"Stats"}]}}}}).state("root.stats.main",{url:"/stats",views:{"stats@root.stats":{templateUrl:"static/html/states/main-stats.html",controller:"StatsController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"stats")}],$title:["$stateParams",function(e){return"Stats"}]}}}}).state("root.stats.indexers",{url:"/indexers",views:{"stats@root.stats":{templateUrl:"static/html/states/indexer-statuses.html",controller:IndexerStatusesController,resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"stats")}],statuses:["$http",function(e){return e.get("internalapi/getindexerstatuses").success(function(e){return e.indexerStatuses})}],$title:["$stateParams",function(e){return"Stats (Indexers)"}]}}}}).state("root.stats.searches",{url:"/searches",views:{"stats@root.stats":{templateUrl:"static/html/states/search-history.html",controller:SearchHistoryController,resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"stats")}],history:["loginRequired","SearchHistoryService",function(e,t){return t.getSearchHistory()}],$title:["$stateParams",function(e){return"Stats (Searches)"}]}}}}).state("root.stats.downloads",{url:"/downloads",views:{"stats@root.stats":{templateUrl:"static/html/states/download-history.html",controller:DownloadHistoryController,resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"stats")}],downloads:["StatsService",function(e){return e.getDownloadHistory()}],$title:["$stateParams",function(e){return"Stats (Downloads)"}]}}}}).state("root.system",{url:"/system",views:{},"abstract":!0}).state("root.system.control",{url:"/control",views:{"container@":{templateUrl:"static/html/states/system.html",controller:"SystemController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],askAdmin:["loginRequired","$http",function(e,t){return t.get("internalapi/askadmin")}],activeTab:[function(){return 0}],$title:["$stateParams",function(e){return"System"}]}}}}).state("root.system.updates",{url:"/updates",views:{"container@":{templateUrl:"static/html/states/system.html",controller:"SystemController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 1}],$title:["$stateParams",function(e){return"System (Updates)"}]}}}}).state("root.system.log",{url:"/log",views:{"container@":{templateUrl:"static/html/states/system.html",controller:"SystemController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 2}],$title:["$stateParams",function(e){return"System (Log)"}]}}}}).state("root.system.backup",{url:"/backup",views:{"container@":{templateUrl:"static/html/states/system.html",controller:"SystemController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 3}],$title:["$stateParams",function(e){return"System (Backup)"}]}}}}).state("root.system.bugreport",{url:"/bugreport",views:{"container@":{templateUrl:"static/html/states/system.html",controller:"SystemController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 4}],$title:["$stateParams",function(e){return"System (Bug report)"}]}}}}).state("root.system.about",{url:"/about",views:{"container@":{templateUrl:"static/html/states/system.html",controller:"SystemController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"admin")}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],activeTab:[function(){return 5}],$title:["$stateParams",function(e){return"System (About)"}]}}}}).state("root.search",{url:"/?category&query&imdbid&tvdbid&title&season&episode&minsize&maxsize&minage&maxage&offsets&rid&mode&tmdbid&indexers",views:{"container@":{templateUrl:"static/html/states/search.html",controller:"SearchController",resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"search")}],safeConfig:["loginRequired","ConfigService",function(e,t){return t.getSafe()}],$title:["$stateParams",function(e){return"Search"}]}}}}).state("root.search.results",{views:{"results@root.search":{templateUrl:"static/html/states/search-results.html",
controller:"SearchResultsController",controllerAs:"srController",options:{inherit:!0},resolve:{loginRequired:["$q","$timeout","$state","HydraAuthService",function(e,t,n,r){return s(e,t,n,r,"search")}],$title:["$stateParams",function(e){var t,n="Search results";return e.title?t=e.title:e.query&&(t=e.query),t&&(n+=" ("+t+")"),n}]}}}}),n.html5Mode(!0),a.setPrefix("nzbhydra"),a.setNotify(!0,!1)}]),nzbhydraapp.config(["paginationTemplateProvider",function(e){e.setPath("static/html/dirPagination.tpl.html")}]),nzbhydraapp.config(["cfpLoadingBarProvider",function(e){e.latencyThreshold=100}]),nzbhydraapp.config(["growlProvider",function(e){e.globalTimeToLive(5e3),e.globalPosition("bottom-right")}]),nzbhydraapp.directive("ngEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$evalAsync(n.ngEnter)}),t.preventDefault())})}}),nzbhydraapp.filter("nzblink",function(){return function(e){var t=new URI("internalapi/getnzb");return t.addQuery("searchResultId",e.searchResultId),t.toString()}}),nzbhydraapp.factory("focus",["$rootScope","$timeout",function(e,t){return function(n){t(function(){e.$broadcast("focusOn",n)})}}]),nzbhydraapp.run(["$rootScope",function(e){e.$on("$stateChangeSuccess",function(t,n,r,o,a){try{e.title=n.views[Object.keys(n.views)[0]].resolve.$title[1](r)}catch(i){}})}]),nzbhydraapp.filter("unsafe",["$sce",function(e){return e.trustAsHtml}]),nzbhydraapp.filter("dereferer",["ConfigService",function(e){return function(t){return e.getSafe().dereferer?e.getSafe().dereferer.replace("$s",escape(t)):t}}]),nzbhydraapp.config(["$provide",function(e){e.decorator("$exceptionHandler",["$delegate","$injector",function(e,t){return function(t,n){e(t,n);try{console.log(t);var r=t.stack.split("\n").map(function(e){return e.trim()});r=r.join("\n")}catch(o){console.error("Unable to log JS exception to server",o)}}}])}]),_.mixin({isNullOrEmpty:function(e){return _.isUndefined(e)||_.isNull(e)||_.isString(e)&&0===e.length}}),nzbhydraapp.factory("sessionInjector",["$injector",function(e){var t={response:function(t){return null!=t.headers("Hydra-MaySeeAdmin")&&e.get("HydraAuthService").setLoggedInByBasic("True"==t.headers("Hydra-MaySeeStats"),"True"==t.headers("Hydra-MaySeeAdmin"),t.headers("Hydra-Username")),t}};return t}]),nzbhydraapp.config(["$httpProvider",function(e){e.interceptors.push("sessionInjector")}]),nzbhydraapp.directive("autoFocus",["$timeout",function(e){return{restrict:"AC",link:function(t,n){e(function(){n[0].focus()},0)}}}]),nzbhydraapp.factory("focus",["$timeout","$window",function(e,t){return function(n){e(function(){var e=t.document.getElementById(n);e&&e.focus()})}}]),nzbhydraapp.directive("eventFocus",["focus",function(e){return function(t,n,r){n.on(r.eventFocus,function(){e(r.eventFocusId)}),t.$on("$destroy",function(){n.off(r.eventFocus)})}}]),angular.module("nzbhydraApp").directive("hydraupdates",hydraupdates),angular.module("nzbhydraApp").directive("titleRow",titleRow),angular.module("nzbhydraApp").directive("titleGroup",titleGroup),angular.module("nzbhydraApp").directive("tabOrChart",tabOrChart),angular.module("nzbhydraApp").directive("searchResult",searchResult),angular.module("nzbhydraApp").directive("otherColumns",otherColumns),otherColumns.$inject=["$http","$templateCache","$compile","$window"],angular.module("nzbhydraApp").controller("NfoModalInstanceCtrl",NfoModalInstanceCtrl),NfoModalInstanceCtrl.$inject=["$scope","$uibModalInstance","nfo"],angular.module("nzbhydraApp").directive("onFinishRender",onFinishRender),onFinishRender.$inject=["$timeout"],angular.module("nzbhydraApp").directive("hydralog",hydralog),angular.module("nzbhydraApp").directive("keepFocus",["$timeout",function(e){return{restrict:"A",require:"ngModel",link:function(t,n,r,o){o.$parsers.unshift(function(t){return e(function(){n[0].focus()}),t})}}}]),angular.module("nzbhydraApp").directive("indexerInput",indexerInput),angular.module("nzbhydraApp").directive("focusOn",focusOn),angular.module("nzbhydraApp").directive("duplicateGroup",duplicateGroup),angular.module("nzbhydraApp").directive("downloadNzbzipButton",downloadNzbzipButton),angular.module("nzbhydraApp").directive("downloadNzbsButton",downloadNzbsButton),angular.module("nzbhydraApp").directive("columnFilterWrapper",columnFilterWrapper),angular.module("nzbhydraApp").directive("freetextFilter",freetextFilter),angular.module("nzbhydraApp").directive("checkboxesFilter",checkboxesFilter),angular.module("nzbhydraApp").directive("booleanFilter",booleanFilter),angular.module("nzbhydraApp").directive("timeFilter",timeFilter),angular.module("nzbhydraApp").directive("columnSortable",columnSortable),angular.module("nzbhydraApp").directive("connectionTest",connectionTest),angular.module("nzbhydraApp").directive("cfgFormEntry",cfgFormEntry),angular.module("nzbhydraApp").directive("hydrabackup",hydrabackup),angular.module("nzbhydraApp").directive("addableNzbs",addableNzbs),angular.module("nzbhydraApp").directive("addableNzb",addableNzb),angular.module("nzbhydraApp").factory("UpdateService",UpdateService),UpdateService.$inject=["$http","growl","blockUI","RestartService"],angular.module("nzbhydraApp").controller("UpdateFooterController",UpdateFooterController),UpdateFooterController.$inject=["$scope","UpdateService","HydraAuthService"],angular.module("nzbhydraApp").controller("SystemController",SystemController),SystemController.$inject=["$scope","$state","activeTab","$http","growl","RestartService","ModalService","UpdateService","NzbHydraControlService"],angular.module("nzbhydraApp").factory("StatsService",StatsService),StatsService.$inject=["$http"],angular.module("nzbhydraApp").controller("StatsController",StatsController),StatsController.$inject=["$scope","$filter","StatsService","blockUI"],angular.module("nzbhydraApp").factory("SearchService",SearchService),SearchService.$inject=["$http"],angular.module("nzbhydraApp").controller("SearchResultsController",SearchResultsController),SearchResultsController.$inject=["$stateParams","$scope","$q","$timeout","blockUI","growl","localStorageService","SearchService","ConfigService"],angular.module("nzbhydraApp").factory("SearchHistoryService",SearchHistoryService),SearchHistoryService.$inject=["$filter","$http"],angular.module("nzbhydraApp").controller("SearchHistoryController",SearchHistoryController),SearchHistoryController.$inject=["$scope","$state","SearchHistoryService","ConfigService","history","$sce","$filter"],angular.module("nzbhydraApp").controller("SearchController",SearchController),SearchController.$inject=["$scope","$http","$stateParams","$state","$window","$filter","$sce","growl","SearchService","focus","ConfigService","HydraAuthService","CategoriesService","blockUI","$element","ModalService","SearchHistoryService"],angular.module("nzbhydraApp").factory("RestartService",RestartService),RestartService.$inject=["blockUI","$timeout","$window","growl","NzbHydraControlService"],angular.module("nzbhydraApp").factory("NzbHydraControlService",NzbHydraControlService),NzbHydraControlService.$inject=["$http"],angular.module("nzbhydraApp").factory("NzbDownloadService",NzbDownloadService),NzbDownloadService.$inject=["$http","ConfigService","DownloaderCategoriesService"],angular.module("nzbhydraApp").factory("ModalService",ModalService),ModalService.$inject=["$uibModal","$q"],angular.module("nzbhydraApp").controller("ModalInstanceCtrl",ModalInstanceCtrl),ModalInstanceCtrl.$inject=["$scope","$uibModalInstance","headline","message","params"],angular.module("nzbhydraApp").service("GeneralModalService",GeneralModalService),angular.module("nzbhydraApp").controller("LoginController",LoginController),LoginController.$inject=["$scope","RequestsErrorHandler","$state","HydraAuthService","growl"],angular.module("nzbhydraApp").controller("IndexerStatusesController",IndexerStatusesController),IndexerStatusesController.$inject=["$scope","$http","statuses"],angular.module("nzbhydraApp").filter("formatDate",formatDate),formatDate.$inject=["dateFilter"],angular.module("nzbhydraApp").filter("reformatDate",reformatDate),angular.module("nzbhydraApp").controller("IndexController",IndexController),IndexController.$inject=["$scope","$http","$stateParams","$state"],angular.module("nzbhydraApp").factory("HydraAuthService",HydraAuthService),HydraAuthService.$inject=["$q","$rootScope","$http","bootstrapped"],angular.module("nzbhydraApp").controller("HeaderController",HeaderController),HeaderController.$inject=["$scope","$state","growl","HydraAuthService","$location"];var HEADER_NAME="MyApp-Handle-Errors-Generically",specificallyHandleInProgress=!1;nzbhydraapp.factory("RequestsErrorHandler",["$q","growl","blockUI","GeneralModalService",function(e,t,n,r){return{specificallyHandled:function(e){specificallyHandleInProgress=!0;try{return e()}finally{specificallyHandleInProgress=!1}},responseError:function(t){n.reset();var o=t&&t.config&&t.config.headers&&t.config.headers[HEADER_NAME]&&!t.config.url.contains("logerror");if(o){var a="An error occured :<br>"+t.status+": "+t.statusText;t.data&&(a+="<br><br>"+t.data),r.open(a)}else t&&t.config&&t.config.headers&&t.config.headers[HEADER_NAME]&&t.config.url.contains("logerror")&&console.log("Not handling connection error while sending exception to server");return e.reject(t)}}}]),nzbhydraapp.config(["$provide","$httpProvider",function(e,t){function n(e){return e=e||{},e.headers=e.headers||{},specificallyHandleInProgress||(e.headers[HEADER_NAME]=!0),e}t.interceptors.push("RequestsErrorHandler"),e.decorator("$http",["$delegate",function(e){function t(t){return function(r,o){return e[t](r,n(o))}}function r(t){return function(r,o,a){return e[t](r,o,n(a))}}function o(t){for(var n in e)t.hasOwnProperty(n)||("function"==typeof e[n]?t[n]=function(){return e.apply(e,arguments)}:t[n]=e[n])}var a=function(t){return e(n(t))};return a.get=t("get"),a["delete"]=t("delete"),a.head=t("head"),a.jsonp=t("jsonp"),a.post=r("post"),a.put=r("put"),o(a),a}])}]),hashCode=function(e){return e.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0)},angular.module("nzbhydraApp").run(["formlyConfig","formlyValidationMessages",function(e,t){t.addStringMessage("required","This field is required"),e.extras.errorExistsAndShouldBeVisibleExpression="fc.$touched || form.$submitted"}]),angular.module("nzbhydraApp").config(["formlyConfigProvider",function(e){e.extras.removeChromeAutoComplete=!0,e.extras.explicitAsync=!0,e.disableWarnings=window.onProd,e.setWrapper({name:"settingWrapper",templateUrl:"setting-wrapper.html"}),e.setWrapper({name:"fieldset",template:["<fieldset>","<legend>{{options.templateOptions.label}}</legend>","<formly-transclude></formly-transclude>","</fieldset>"].join(" ")}),e.setType({name:"help",template:['<div class="panel panel-default">','<div class="panel-body">','<div ng-repeat="line in options.templateOptions.lines">{{ line }}</div>',"</div>","</div>"].join(" ")}),e.setWrapper({name:"logicalGroup",template:["<formly-transclude></formly-transclude>"].join(" ")}),e.setType({name:"horizontalInput","extends":"input",wrapper:["settingWrapper","bootstrapHasError"]}),e.setType({name:"timeOfDay","extends":"horizontalInput",controller:["$scope",function(e){e.model[e.options.key]=moment.utc(e.model[e.options.key]).toDate()}]}),e.setType({name:"percentInput",template:['<input type="number" class="form-control" placeholder="Percent" ng-model="model[options.key]" ng-pattern="/^[0-9]+(.[0-9]{1,2})?$/" step="0.01" required />'].join(" ")}),e.setType({name:"apiKeyInput",template:['<div class="input-group">','<input type="text" class="form-control" ng-model="model[options.key]"/>','<span class="input-group-btn input-group-btn2">','<button class="btn btn-default" type="button" ng-click="generate()"><span class="glyphicon glyphicon-refresh"></span></button>',"</div>"].join(" "),controller:function(e){e.generate=function(){for(var t="",n=24,r="0123456789abcdefghijklmnopqrstuvwxyz",o=n;o>0;--o)t+=r[Math.floor(Math.random()*r.length)];e.model[e.options.key]=t}}}),e.setType({name:"testConnection",templateUrl:"button-test-connection.html"}),e.setType({name:"horizontalTestConnection","extends":"testConnection",wrapper:["settingWrapper","bootstrapHasError"]}),e.setType({name:"checkCaps",templateUrl:"button-check-caps.html",controller:function(e,t,n){function r(){angular.element(a).removeClass("btn-default"),angular.element(a).removeClass("btn-danger"),angular.element(a).addClass("btn-success")}function o(){angular.element(a).removeClass("btn-default"),angular.element(a).removeClass("btn-success"),angular.element(a).addClass("btn-danger")}e.message="",e.uniqueId=hashCode(e.model.name)+hashCode(e.model.host);var a="#button-check-caps-"+e.uniqueId,i="#message-check-caps-"+e.uniqueId;e.checkCaps=function(){angular.element(a).addClass("glyphicon-refresh-animate");var s="internalapi/test_caps",l={indexer:e.model.name,apikey:e.model.apikey,host:e.model.host};angular.isDefined(e.model.username)&&(l.username=e.model.username,l.password=e.model.password),t.checkCaps(s,l,e.model).then(function(e,t){angular.element(i).text(e.supportedIds&&e.supportedTypes),r()},function(e){angular.element(i).text(e),o(),n.open("Error testing capabilities",'The capabilities of the indexer could not be checked. You can set the IDs manually. Refer to the <a href="https://github.com/theotherp/nzbhydra/wiki/Supported-Search-Types-And-Indexer-Hosts" target="_blank">Wiki</a> for the IDs supported by some indexers.<br><br>You may repeat the check at any time to try again.')})["finally"](function(){angular.element(a).removeClass("glyphicon-refresh-animate")})}}}),e.setType({name:"horizontalCheckCaps","extends":"checkCaps",wrapper:["settingWrapper","bootstrapHasError"]}),e.setType({name:"horizontalApiKeyInput","extends":"apiKeyInput",wrapper:["settingWrapper","bootstrapHasError"]}),e.setType({name:"horizontalPercentInput","extends":"percentInput",wrapper:["settingWrapper","bootstrapHasError"]}),e.setType({name:"switch",template:'<div style="text-align:left"><input bs-switch type="checkbox" ng-model="model[options.key]"/></div>'}),e.setType({name:"duoSetting","extends":"input",defaultOptions:{className:"col-md-9",templateOptions:{type:"number",noRow:!0,label:""}}}),e.setType({name:"horizontalSwitch","extends":"switch",wrapper:["settingWrapper","bootstrapHasError"]}),e.setType({name:"horizontalSelect","extends":"select",wrapper:["settingWrapper","bootstrapHasError"]}),e.setType({name:"horizontalMultiselect",defaultOptions:{templateOptions:{optionsAttr:"bs-options",ngOptions:"option[to.valueProp] as option in to.options | filter: $select.search",valueProp:"id",labelProp:"label",getPlaceholder:function(){return""}}},templateUrl:"ui-select-multiple.html",wrapper:["settingWrapper","bootstrapHasError"]}),e.setType({name:"label",template:'<label class="control-label">{{to.label}}</label>'}),e.setType({name:"duolabel","extends":"label",defaultOptions:{className:"col-md-2",templateOptions:{label:"-"}}}),e.setType({name:"repeatSection",templateUrl:"repeatSection.html",controller:function(e){function t(t){return t=angular.copy(t),e.repeatfields=t,t}function n(){e.model[e.options.key]=e.model[e.options.key]||[];var t=e.model[e.options.key],n=angular.copy(e.options.templateOptions.defaultModel);t.push(n)}function r(t){e.model[e.options.key].splice(t,1)}e.formOptions={formState:e.formState},e.addNew=n,e.remove=r,e.copyFields=t,e.clear=function(t){return _.mapObject(t,function(t,n){return"object"==typeof n?e.clear(n):void 0})}}}),e.setType({name:"arrayConfig",templateUrl:"arrayConfig.html",controller:function(e,t,n){function r(n,r,o,a){var i=t.open({templateUrl:"configBox.html",controller:"ConfigBoxInstanceController",size:"lg",resolve:{model:function(){return n},fields:function(){return e.options.data.fieldsFunction(n,r,o,angular.injector())},isInitial:function(){return o},parentModel:function(){return r},data:function(){return e.options.data}}});i.result.then(function(){e.form.$setDirty(!0),angular.isDefined(a)&&a(!0)},function(){angular.isDefined(a)&&a(!1)})}function o(t,n){e._showBox(t,n,!1)}e.formOptions={formState:e.formState},e._showBox=r,e.showBox=o,e.isInitial=!1,e.presets=e.options.data.presets(e.model),e.addEntry=function(t,r){if(e.options.data.checkAddingAllowed(t,r)){var o=angular.copy(e.options.data.defaultModel);angular.isDefined(r)&&_.extend(o,r),e.isInitial=!0,e._showBox(o,t,!0,function(e){e&&t.push(o)})}else n.error("That predefined indexer is already configured.")}}})}]),angular.module("nzbhydraApp").controller("ConfigBoxInstanceController",["$scope","$q","$uibModalInstance","$http","model","fields","isInitial","parentModel","data","growl",function(e,t,n,r,o,a,i,s,l,c){e.model=o,e.fields=a,e.isInitial=i,e.allowDelete=l.allowDeleteFunction(o),e.spinnerActive=!1,e.needsConnectionTest=!1,e.obSubmit=function(){if(console.log(e),e.form.$valid){l.checkBeforeClose(e,o).then(function(){n.close(e)})}else c.error("Config invalid. Please check your settings."),angular.forEach(e.form.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})})},e.reset=function(){e.reset()},e.deleteEntry=function(){s.splice(s.indexOf(o),1),n.close(e)},e.reset=function(){angular.isDefined(l.resetFunction)&&l.resetFunction(e)},e.$on("modal.closing",function(t,n){"backdrop click"==n&&e.reset(e)})}]),angular.module("nzbhydraApp").factory("ConfigBoxService",ConfigBoxService),ConfigBoxService.$inject=["$http","$q"];var filters=angular.module("filters",[]);filters.filter("bytes",function(){return function(e){return filesize(e)}}),filters.filter("unsafe",["$sce",function(e){return function(t,n){return e.trustAs(n||"html",text)}}]),angular.module("nzbhydraApp").factory("FileDownloadService",FileDownloadService),FileDownloadService.$inject=["$http","growl"],angular.module("nzbhydraApp").factory("DownloaderCategoriesService",DownloaderCategoriesService),DownloaderCategoriesService.$inject=["$http","$q","$uibModal"],angular.module("nzbhydraApp").controller("DownloaderCategorySelectionController",["$scope","$uibModalInstance","DownloaderCategoriesService","categories",function(e,t,n,r){console.log(r),e.categories=r,e.select=function(r){n.select(r),t.close(e)}}]),angular.module("nzbhydraApp").controller("DownloadHistoryController",DownloadHistoryController),DownloadHistoryController.$inject=["$scope","StatsService","downloads","ConfigService"],angular.module("nzbhydraApp").filter("reformatDateEpoch",reformatDateEpoch),angular.module("nzbhydraApp").factory("ConfigService",ConfigService),ConfigService.$inject=["$http","$q","$cacheFactory","bootstrapped"],angular.module("nzbhydraApp").factory("ConfigFields",ConfigFields),ConfigFields.$inject=["$injector"],angular.module("nzbhydraApp").factory("IndexerCheckBeforeCloseService",IndexerCheckBeforeCloseService),IndexerCheckBeforeCloseService.$inject=["$q","ModalService","ConfigBoxService","blockUI","growl"],angular.module("nzbhydraApp").factory("DownloaderCheckBeforeCloseService",DownloaderCheckBeforeCloseService),DownloaderCheckBeforeCloseService.$inject=["$q","ConfigBoxService","growl","ModalService","blockUI"],angular.module("nzbhydraApp").factory("ConfigModel",function(){return{}}),angular.module("nzbhydraApp").factory("ConfigWatcher",function(){function e(e){t=e,t.$watchGroup(["config.main.host"],function(){},!0)}var t;return{watch:e}}),angular.module("nzbhydraApp").controller("ConfigController",ConfigController),ConfigController.$inject=["$scope","$http","activeTab","ConfigService","config","DownloaderCategoriesService","ConfigFields","ConfigModel","ModalService","RestartService","$state","growl"],angular.module("nzbhydraApp").factory("CategoriesService",CategoriesService),CategoriesService.$inject=["ConfigService"],angular.module("nzbhydraApp").factory("BackupService",BackupService),BackupService.$inject=["$http"];
//# sourceMappingURL=nzbhydra.js.map
